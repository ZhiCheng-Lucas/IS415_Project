<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chong Zhi Cheng">
<meta name="dcterms.date" content="2024-09-16">

<title>IS415 - Geospatial Analytics for Social Good: Unveiling the Spatial and Temporal Dynamics of Armed Conflict in Myanmar (2021-2024)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1: Introduction to Geospatial Analytics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2: GeoVisualisation and Analytical Mapping</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3: Spatial Point Patterns Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4: Advanced Spatial Point Patterns Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5: Spatial Weights and Applications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6: Measures of Global and Local Spatial Association</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7: Shiny for Building Web-enabled Geospatial Analytics Application</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8: Hierarchical Clustering for Multivariate Geographically Referenced Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 9: Spatially Constrained Cluster Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise 10: Regression Modelling of Geographically Reference Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise 11: Geographically Weighted Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex12/Hands-on_Ex12.html">
 <span class="dropdown-text">Hands-on Exercise 12: Geographically Weighted Predictive Modelling</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-Class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex01/In-Class_Ex01.html">
 <span class="dropdown-text">In-Class Exercise 1: Introduction to Geospatial Analytics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex02/In-Class_Ex02.html">
 <span class="dropdown-text">In-Class Exercise 2: GeoVisualisation and Analytical Mapping</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex03/In-Class_Ex03.html">
 <span class="dropdown-text">In-Class Exercise 3: Spatial Point Patterns Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex04/In-Class_Ex04.html">
 <span class="dropdown-text">In-Class Exercise 4: Advanced Spatial Point Patterns Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex05/In-Class_Ex05.html">
 <span class="dropdown-text">In-Class Exercise 5: Spatial Weights and Applications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex06/In-Class_Ex06.html">
 <span class="dropdown-text">In-Class Exercise 6: Measures of Global and Local Spatial Association</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex07/In-Class_Ex07.html">
 <span class="dropdown-text">In-Class Exercise 7: Shiny for Building Web-enabled Geospatial Analytics Application</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex08/In-Class_Ex08.html">
 <span class="dropdown-text">In-Class Exercise 8: Hierarchical Clustering for Multivariate Geographically Referenced Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex09/In-Class_Ex09.html">
 <span class="dropdown-text">In-Class Exercise 9: Spatially Constrained Cluster Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex10/In-Class_Ex10.html">
 <span class="dropdown-text">In-Class Exercise 10: Regression Modelling of Geographically Reference Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex11/In-Class_Ex11.html">
 <span class="dropdown-text">In-Class Exercise 11: Geographically Weighted Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex12/In-Class_Ex12.html">
 <span class="dropdown-text">In-Class Exercise 12: Geographically Weighted Predictive Modelling</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-takehome-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Takehome Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-takehome-exercise">    
        <li>
    <a class="dropdown-item" href="../../Takehome_Ex/Takehome_Ex1/Takehome_Ex1.html">
 <span class="dropdown-text">Takehome Exercise 1: Unveiling the Spatial and Temporal Dynamics of Armed Conflict in Myanmar</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Takehome_Ex/Takehome_Ex2/Takehome_Ex2.html">
 <span class="dropdown-text">Takehome Exercise 2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Takehome_Ex/Takehome_Ex3/Takehome_Ex3.html">
 <span class="dropdown-text">Takehome Exercise 3: Spatial Distribution Analysis of Educational Facilities in Jakarta</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#simplified-historical-context-and-current-conflict" id="toc-simplified-historical-context-and-current-conflict" class="nav-link active" data-scroll-target="#simplified-historical-context-and-current-conflict">Simplified Historical Context and Current Conflict</a>
  <ul class="collapse">
  <li><a href="#situation-overview" id="toc-situation-overview" class="nav-link" data-scroll-target="#situation-overview">Situation Overview</a></li>
  <li><a href="#key-actors-in-the-myanmar-conflict" id="toc-key-actors-in-the-myanmar-conflict" class="nav-link" data-scroll-target="#key-actors-in-the-myanmar-conflict">Key Actors in the Myanmar Conflict</a>
  <ul class="collapse">
  <li><a href="#myanmar-military-junta" id="toc-myanmar-military-junta" class="nav-link" data-scroll-target="#myanmar-military-junta">Myanmar Military ( Junta )</a></li>
  <li><a href="#peoples-defense-force" id="toc-peoples-defense-force" class="nav-link" data-scroll-target="#peoples-defense-force">People’s Defense Force</a></li>
  <li><a href="#three-brotherhood-alliance-and-other-armed-forces" id="toc-three-brotherhood-alliance-and-other-armed-forces" class="nav-link" data-scroll-target="#three-brotherhood-alliance-and-other-armed-forces">Three Brotherhood Alliance and other Armed Forces</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-sources-and-parameters" id="toc-data-sources-and-parameters" class="nav-link" data-scroll-target="#data-sources-and-parameters">Data Sources and Parameters</a>
  <ul class="collapse">
  <li><a href="#armed-conflict-data" id="toc-armed-conflict-data" class="nav-link" data-scroll-target="#armed-conflict-data">Armed conflict data</a>
  <ul class="collapse">
  <li><a href="#data-characteristics" id="toc-data-characteristics" class="nav-link" data-scroll-target="#data-characteristics">Data Characteristics</a></li>
  <li><a href="#acled-data-columns" id="toc-acled-data-columns" class="nav-link" data-scroll-target="#acled-data-columns">ACLED Data Columns</a></li>
  </ul></li>
  <li><a href="#gis-data" id="toc-gis-data" class="nav-link" data-scroll-target="#gis-data">GIS Data</a></li>
  </ul></li>
  <li><a href="#data-import-and-initial-transformation-analysis" id="toc-data-import-and-initial-transformation-analysis" class="nav-link" data-scroll-target="#data-import-and-initial-transformation-analysis">Data Import and Initial Transformation &amp; Analysis</a>
  <ul class="collapse">
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">Exploratory Data Analysis</a></li>
  </ul></li>
  <li><a href="#first-order-spatial-temporal-patterns-analysis-understanding-conflict-trends-in-myanmar" id="toc-first-order-spatial-temporal-patterns-analysis-understanding-conflict-trends-in-myanmar" class="nav-link" data-scroll-target="#first-order-spatial-temporal-patterns-analysis-understanding-conflict-trends-in-myanmar">First-order Spatial-Temporal Patterns Analysis: Understanding Conflict Trends in Myanmar</a>
  <ul class="collapse">
  <li><a href="#kernel-density-estimation-kde" id="toc-kernel-density-estimation-kde" class="nav-link" data-scroll-target="#kernel-density-estimation-kde">Kernel Density Estimation (KDE)</a></li>
  <li><a href="#visualization-of-the-various-kde-maps-by-quarter" id="toc-visualization-of-the-various-kde-maps-by-quarter" class="nav-link" data-scroll-target="#visualization-of-the-various-kde-maps-by-quarter">Visualization of the various KDE maps by quarter</a></li>
  <li><a href="#animation-of-the-conflict-density-in-myanmar-over-time" id="toc-animation-of-the-conflict-density-in-myanmar-over-time" class="nav-link" data-scroll-target="#animation-of-the-conflict-density-in-myanmar-over-time">Animation of the Conflict Density in Myanmar over Time</a></li>
  <li><a href="#spatio-temporal-kernel-density-estimation" id="toc-spatio-temporal-kernel-density-estimation" class="nav-link" data-scroll-target="#spatio-temporal-kernel-density-estimation">Spatio-Temporal kernel density estimation</a></li>
  </ul></li>
  <li><a href="#second-order-spatial-temporal-patterns-analysis" id="toc-second-order-spatial-temporal-patterns-analysis" class="nav-link" data-scroll-target="#second-order-spatial-temporal-patterns-analysis">Second-order Spatial-Temporal Patterns Analysis</a>
  <ul class="collapse">
  <li><a href="#central-regions-analysis" id="toc-central-regions-analysis" class="nav-link" data-scroll-target="#central-regions-analysis">Central Regions Analysis</a>
  <ul class="collapse">
  <li><a href="#sagaing" id="toc-sagaing" class="nav-link" data-scroll-target="#sagaing">Sagaing</a></li>
  <li><a href="#mandalay" id="toc-mandalay" class="nav-link" data-scroll-target="#mandalay">Mandalay</a></li>
  <li><a href="#magway" id="toc-magway" class="nav-link" data-scroll-target="#magway">Magway</a></li>
  <li><a href="#central-region-analysis" id="toc-central-region-analysis" class="nav-link" data-scroll-target="#central-region-analysis">Central Region Analysis</a></li>
  </ul></li>
  <li><a href="#southern-region-yangon" id="toc-southern-region-yangon" class="nav-link" data-scroll-target="#southern-region-yangon">Southern-Region : Yangon</a>
  <ul class="collapse">
  <li><a href="#g-function-3" id="toc-g-function-3" class="nav-link" data-scroll-target="#g-function-3">G-Function</a></li>
  <li><a href="#l-function-3" id="toc-l-function-3" class="nav-link" data-scroll-target="#l-function-3">L-Function</a></li>
  <li><a href="#l-function-over-time-3" id="toc-l-function-over-time-3" class="nav-link" data-scroll-target="#l-function-over-time-3">L-Function over time</a></li>
  <li><a href="#spatio-temporal-kernel-density-estimation-4" id="toc-spatio-temporal-kernel-density-estimation-4" class="nav-link" data-scroll-target="#spatio-temporal-kernel-density-estimation-4">Spatio-Temporal kernel density estimation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#visualization-of-conflict-density-using-openstreetmap" id="toc-visualization-of-conflict-density-using-openstreetmap" class="nav-link" data-scroll-target="#visualization-of-conflict-density-using-openstreetmap">Visualization of Conflict Density Using OpenStreetMap</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#bonus-section-predictive-conflict-analysis" id="toc-bonus-section-predictive-conflict-analysis" class="nav-link" data-scroll-target="#bonus-section-predictive-conflict-analysis">Bonus Section : Predictive Conflict Analysis</a>
  <ul class="collapse">
  <li><a href="#forecast-analysis" id="toc-forecast-analysis" class="nav-link" data-scroll-target="#forecast-analysis">Forecast Analysis</a></li>
  </ul></li>
  <li><a href="#conclusion-spatio-temporal-patterns-analysis-summary" id="toc-conclusion-spatio-temporal-patterns-analysis-summary" class="nav-link" data-scroll-target="#conclusion-spatio-temporal-patterns-analysis-summary">Conclusion: Spatio-Temporal Patterns Analysis Summary</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Geospatial Analytics for Social Good: Unveiling the Spatial and Temporal Dynamics of Armed Conflict in Myanmar (2021-2024)</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Chong Zhi Cheng </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 16, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">September 20, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<p>The application of geospatial analytics to complex societal challenges has emerged as a powerful tool for understanding and addressing global issues. This study leverages advanced spatial and spatio-temporal point pattern analysis techniques to examine the geographical distribution and evolution of armed conflict in Myanmar following the military coup of February 1, 2021.</p>
<p>To provide more context for this analysis, readers are encouraged to explore two key resources:</p>
<ol type="1">
<li><p>The International Institute for Strategic Studies (IISS) offers an interactive map of the conflict, along with a concise introduction to the situation in Myanmar. This resource can be accessed at <a href="https://myanmar.iiss.org/" class="uri">https://myanmar.iiss.org/</a></p></li>
<li><p>For a comprehensive understanding of the conflict, the Special Advisory Council for Myanmar has published an in-depth report, available at <a href="https://specialadvisorycouncil.org/" class="uri">https://specialadvisorycouncil.org/</a>.</p></li>
</ol>
<p>These resources complement our geospatial analysis by providing crucial background information and additional perspectives on the ongoing conflict in Myanmar.</p>
<section id="simplified-historical-context-and-current-conflict" class="level1">
<h1>Simplified Historical Context and Current Conflict</h1>
<p>Myanmar has a long history of political instability, but the current conflict stems from a military coup that occurred on February 1, 2021. This event marked a critical turning point in the country’s fragile democratic transition.</p>
<p><img src="timeline.PNG" class="img-fluid"></p>
<p><em>Image source: The New York Times, “What’s Happening in Myanmar’s Civil War?,” April 20, 2024</em></p>
<p><a href="https://www.nytimes.com/interactive/2024/04/20/world/asia/myanmar-civil-war.html" class="uri">https://www.nytimes.com/interactive/2024/04/20/world/asia/myanmar-civil-war.html</a></p>
<p>On 1 February 2021, the military in Myanmar seized power as the elected National League for Democracy (NLD) government was set to begin its second term, having won the November 2020 general election.</p>
<p>Alleging the NLD had engaged in electoral fraud, the military set about arresting NLD officials and other activists. The public response to the coup was to take to the streets in a rejection of a return to military rule. The military responded to the demonstrations with excessive force, killing hundreds of peaceful protesters.</p>
<p>As military violence throughout the country increased, armed local defense forces emerged to protect communities. The coup has also set off a wave of renewed fighting in areas with ethnic armed groups. (<em>for more, see ACLED’s recent report: <a href="https://acleddata.com/2021/07/22/myanmars-spring-revolution/">Myanmar’s Spring Revolution</a></em>).</p>
<section id="situation-overview" class="level2">
<h2 class="anchored" data-anchor-id="situation-overview">Situation Overview</h2>
<p>The conflict in Myanmar presents a highly complex and nuanced scenario that defies simple categorization. While this report aims to provide a comprehensive analysis, it is important to acknowledge that the following overview represents a necessarily simplified version of the ongoing situation.</p>
<p>In the aftermath of the 2021 military coup, two primary opposition forces emerged to challenge the ruling junta: the People’s Defense Force and the Three Brotherhood Alliance. These groups, while often working in concert against the military government, maintain distinct identities and operational structures. It is crucial to note that despite their shared opposition to the junta, these entities are not formally allied nor do they constitute a single, unified force.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="indepthv2.PNG" class="img-fluid figure-img"></p>
<figcaption>Map showing areas of control by various groups in Myanmar</figcaption>
</figure>
</div>
<p><em>Source: Special Advisory Council for Myanmar</em></p>
<p>The following is a simplified version of the map by New York Times.</p>
<p><img src="Myanmar_controlMap.PNG" class="img-fluid"></p>
<p><em>Image source: The New York Times, “What’s Happening in Myanmar’s Civil War?,” April 20, 2024</em></p>
<p>The military junta maintains control over a central corridor stretching from Mandalay southward to Yangon, encompassing the country’s traditional centers of power and economic activity. In contrast, resistance forces have established footholds in many peripheral regions, particularly in the country’s border areas.</p>
<p>Key contested zones have emerged at the intersection of several administrative regions, notably where Sagaing, Magway, Mandalay, and Shan states converge. Additionally, the outskirts of Yangon, Myanmar’s largest city and former capital, have evolved into another significant battleground, underscoring the conflict’s reach into urban centers.</p>
</section>
<section id="key-actors-in-the-myanmar-conflict" class="level2">
<h2 class="anchored" data-anchor-id="key-actors-in-the-myanmar-conflict">Key Actors in the Myanmar Conflict</h2>
<section id="myanmar-military-junta" class="level3">
<h3 class="anchored" data-anchor-id="myanmar-military-junta">Myanmar Military ( Junta )</h3>
<p>The Myanmar Military, also known as the Tatmadaw, seized power on February 1, 2021, overthrowing the democratically elected government. Currently, they maintain nominal control over the country, though their authority is increasingly challenged by various opposition forces.</p>
</section>
<section id="peoples-defense-force" class="level3">
<h3 class="anchored" data-anchor-id="peoples-defense-force">People’s Defense Force</h3>
<p>The term “People’s Defense Force” encompasses three distinct types of armed groups that have emerged since the coup:</p>
<ol type="1">
<li><p><strong>People’s Defense Forces (PDFs)</strong>: These are larger armed units formed or recognized by the National Unity Government (NUG), a shadow civilian government primarily composed of democratically elected lawmakers ousted in the coup. PDFs operate under joint command systems established by the NUG and several ethnic armed organizations (EAOs), many of which have been in conflict with the Tatmadaw for decades.</p></li>
<li><p><strong>Local Defense Forces (LDFs)</strong>: These are local militias operating autonomously at the community level, often pursuing missions independent of the NUG’s directives.</p></li>
<li><p><strong>People’s Defense Teams (PaKhaPha/PDTs)</strong>: These are localized guerrilla units formed for local defense and security purposes.</p></li>
</ol>
<p>The key distinction lies in their operational scope and structure: PDFs are more regularized military units operating across townships and states/regions, while LDFs and PDTs function as self-defense or community security militias at a more localize level.</p>
<p><a href="https://www.usip.org/publications/2022/11/understanding-peoples-defense-forces-myanmar" class="uri">https://www.usip.org/publications/2022/11/understanding-peoples-defense-forces-myanmar</a></p>
</section>
<section id="three-brotherhood-alliance-and-other-armed-forces" class="level3">
<h3 class="anchored" data-anchor-id="three-brotherhood-alliance-and-other-armed-forces">Three Brotherhood Alliance and other Armed Forces</h3>
<p>The Three Brotherhood Alliance is made up of various ethnic armed groups with the key ones being the Arakan Army, the Myanmar National Democratic Alliance Army (MNDAA), and the Ta’ang National Liberation Army (TNLA).</p>
<ul>
<li><p><strong>Arakan Army:</strong> Founded in 2009, the Arakan Army is believed to have some 30,000 soldiers. Their spoken mission is to restore the sovereignty of the multi-ethnic Arakanese in the western state of Rakhine. The group has recruited troops from the Rohingya, a minority mostly Muslim group from Rakhine, who were the target of a brutal military crackdown that is now the subject of a genocide case at the International Court of Justice.</p></li>
<li><p><strong>Myanmar National Democratic Alliance Army (MNDAA):</strong> The MNDAA operates near the Chinese border in northern Shan state. The group says it is fighting for autonomy for the Kokang people, a Han-speaking ethnic group. MNDAA controlled Shan for about 20 years as a special region of Myanmar, during which the narcotics trade boomed. Armed conflicts between the group and the military broke out in 2009 after it was ordered to become a border force, and give up control. MNDAA said earlier this month it had taken control of Laukkai, a town notorious for transnational human trafficking and online scams, that it lost in the 2009 conflict.</p></li>
<li><p><strong>Ta’ang National Liberation Army (TNLA): T</strong>he TNLA is the armed wing of the Palaung Self Liberation Front, a political organisation founded by Tar Aik Bong and Tar Bone Kyaw, both former fighters from the fringe Ta’ang minority group. Its latest incarnation was formed in 1992 and says it is fighting for “real federalism” in Myanmar. The TNLA claims to have 5,000 fighters, although it has been linked to forced recruitment campaigns in rural villages.</p></li>
</ul>
<p>While these three groups form the core of the alliance, they are also aligned with other ethnic armed groups. For the purposes of this analysis, these additional groups are considered under the umbrella of the Three Brotherhood Alliance.</p>
<p><a href="https://www.aljazeera.com/news/2024/1/16/what-is-myanmars-three-brotherhood-alliance-thats-resisting-the-military" class="uri">https://www.aljazeera.com/news/2024/1/16/what-is-myanmars-three-brotherhood-alliance-thats-resisting-the-military</a></p>
</section>
</section>
</section>
<section id="data-sources-and-parameters" class="level1">
<h1>Data Sources and Parameters</h1>
<section id="armed-conflict-data" class="level2">
<h2 class="anchored" data-anchor-id="armed-conflict-data">Armed conflict data</h2>
<p>This study utilizes armed conflict data for Myanmar spanning from January 2021 to June 2024. The primary data source is the <a href="https://acleddata.com/">Armed Conflict Location &amp; Event Data (ACLED)</a>, an independent, impartial, and international non-profit organization. ACLED is renowned for its comprehensive collection of data on violent conflicts and protests across all countries and territories worldwide.</p>
<section id="data-characteristics" class="level3">
<h3 class="anchored" data-anchor-id="data-characteristics">Data Characteristics</h3>
<ol type="1">
<li><p><strong>Time Frame</strong>: The analysis covers a period of 3.5 years, from January 2021 to June 2024. This timeframe captures the evolution of the conflict from its inception following the military coup on February 1, 2021.</p></li>
<li><p><strong>Temporal Resolution</strong>: The data is aggregated and analyzed on a quarterly basis, allowing for the identification of seasonal patterns and medium-term trends in conflict intensity and distribution.</p></li>
<li><p><strong>Spatial Coverage</strong>: The dataset encompasses the entire territory of Myanmar, allowing for a comprehensive analysis of conflict patterns across different regions and administrative divisions.</p></li>
<li><p><strong>Data Currency</strong>: The ACLED dataset used in this analysis was last updated on September 16, 2024.</p></li>
</ol>
</section>
<section id="acled-data-columns" class="level3">
<h3 class="anchored" data-anchor-id="acled-data-columns">ACLED Data Columns</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th>Field Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ISO</td>
<td>A numeric code for each individual country</td>
</tr>
<tr class="even">
<td>EVENT_ID_CNTY</td>
<td>An individual event identifier by number and country acronym</td>
</tr>
<tr class="odd">
<td>EVENT_ID_NO_CNTY</td>
<td>An individual event numeric identifier</td>
</tr>
<tr class="even">
<td>EVENT_DATE</td>
<td>Recorded as Day / Month / Year</td>
</tr>
<tr class="odd">
<td>YEAR</td>
<td>The year in which an event took place</td>
</tr>
<tr class="even">
<td>TIME_PRECISION</td>
<td>A numeric code indicating the level of certainty of the date coded for the event (1-3)</td>
</tr>
<tr class="odd">
<td>EVENT_TYPE</td>
<td>The type of event</td>
</tr>
<tr class="even">
<td>SUB_EVENT_TYPE</td>
<td>The type of sub-event</td>
</tr>
<tr class="odd">
<td>ACTOR1</td>
<td>A named actor involved in the event</td>
</tr>
<tr class="even">
<td>ASSOC_ACTOR_1</td>
<td>The named actor associated with or identifying with ACTOR1 in one specific event</td>
</tr>
<tr class="odd">
<td>INTER1</td>
<td>A numeric code indicating the type of ACTOR1</td>
</tr>
<tr class="even">
<td>ACTOR2</td>
<td>The named actor involved in the event. If a dyadic event, there will also be an “Actor 1”</td>
</tr>
<tr class="odd">
<td>ASSOC_ACTOR_2</td>
<td>The named actor associated with or identifying with ACTOR2 in one specific event</td>
</tr>
<tr class="even">
<td>INTER2</td>
<td>A numeric code indicating the type of ACTOR2</td>
</tr>
<tr class="odd">
<td>INTERACTION</td>
<td>A numeric code indicating the interaction between types of ACTOR1 and ACTOR2. Coded as an interaction between actor types, and recorded as lowest joint number</td>
</tr>
<tr class="even">
<td>REGION</td>
<td>The region of the world where the event took place</td>
</tr>
<tr class="odd">
<td>COUNTRY</td>
<td>The country in which the event took place</td>
</tr>
<tr class="even">
<td>ADMIN1</td>
<td>The largest sub-national administrative region in which the event took place</td>
</tr>
<tr class="odd">
<td>ADMIN2</td>
<td>The second largest sub-national administrative region in which the event took place</td>
</tr>
<tr class="even">
<td>ADMIN3</td>
<td>The third largest sub-national administrative region in which the event took place</td>
</tr>
<tr class="odd">
<td>LOCATION</td>
<td>The location in which the event took place</td>
</tr>
<tr class="even">
<td>LATITUDE</td>
<td>The latitude of the location</td>
</tr>
<tr class="odd">
<td>LONGITUDE</td>
<td>The longitude of the location</td>
</tr>
<tr class="even">
<td>GEO_PRECISION</td>
<td>A numeric code indicating the level of certainty of the location coded for the event</td>
</tr>
<tr class="odd">
<td>SOURCE</td>
<td>The source(s) used to code the event</td>
</tr>
<tr class="even">
<td>SOURCE SCALE</td>
<td>The geographic scale of the sources used to code the event</td>
</tr>
<tr class="odd">
<td>NOTES</td>
<td>A short description of the event</td>
</tr>
<tr class="even">
<td>FATALITIES</td>
<td>Number or estimate of fatalities due to event. These are frequently different across reports</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="gis-data" class="level2">
<h2 class="anchored" data-anchor-id="gis-data">GIS Data</h2>
<ul>
<li><a href="http://geonode.themimu.info/layers/?limit=100&amp;offset=0">Geospatial data</a> on <a href="http://www.themimu.info/">Myanmar Information Management Unit, MIMU</a></li>
</ul>
</section>
</section>
<section id="data-import-and-initial-transformation-analysis" class="level1">
<h1>Data Import and Initial Transformation &amp; Analysis</h1>
<p>Our analysis begins with the crucial step of importing and preparing the data for geospatial analysis. We use two primary data sources:</p>
<ol type="1">
<li><p><strong>Armed Conflict Data</strong>: Sourced from the Armed Conflict Location &amp; Event Data (ACLED) project.</p></li>
<li><p><strong>Administrative Boundary Data</strong>: Shapefiles obtained from the Myanmar Information Management Unit (MIMU).</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, raster, spatstat, tmap, tidyverse, viridis,classInt,maptools,OpenStreetMap,stars,spdep,prophet,tmaptools,sparr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import conflict data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>conflict_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/2021-01-01-2024-06-30-Myanmar.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to sf object</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a quarter column and parse the date correctly</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">event_date =</span> <span class="fu">dmy</span>(event_date),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">quarter =</span> <span class="fu">paste0</span>(<span class="fu">year</span>(event_date), <span class="st">"-Q"</span>, <span class="fu">quarter</span>(event_date))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select relevant columns</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    event_id_cnty, event_date, year, quarter, time_precision,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    disorder_type, event_type, sub_event_type,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    actor1, assoc_actor_1, inter1, actor2, assoc_actor_2, inter2, interaction,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    civilian_targeting, region, country, admin1, admin2, admin3,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    location, geo_precision, source, source_scale, notes, fatalities,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    tags, timestamp, population_best</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Import administrative boundary data</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>adm0 <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/adm0"</span>, <span class="at">layer =</span> <span class="st">"mmr_polbnda_adm0_250k_mimu_1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `mmr_polbnda_adm0_250k_mimu_1' from data source 
  `C:\zcchong\IS415\Takehome_Ex\Takehome_Ex1\data\adm0' using driver `ESRI Shapefile'
Simple feature collection with 1 feature and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>adm1 <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/adm1"</span>, <span class="at">layer =</span> <span class="st">"mmr_polbnda_adm1_250k_mimu_1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `mmr_polbnda_adm1_250k_mimu_1' from data source 
  `C:\zcchong\IS415\Takehome_Ex\Takehome_Ex1\data\adm1' using driver `ESRI Shapefile'
Simple feature collection with 15 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>adm2 <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/adm2"</span>, <span class="at">layer =</span> <span class="st">"mmr_polbnda_adm2_250k_mimu"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `mmr_polbnda_adm2_250k_mimu' from data source 
  `C:\zcchong\IS415\Takehome_Ex\Takehome_Ex1\data\adm2' using driver `ESRI Shapefile'
Simple feature collection with 80 features and 7 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>adm3 <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/adm3"</span>, <span class="at">layer =</span> <span class="st">"mmr_polbnda_adm3_250k_mimu_1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `mmr_polbnda_adm3_250k_mimu_1' from data source 
  `C:\zcchong\IS415\Takehome_Ex\Takehome_Ex1\data\adm3' using driver `ESRI Shapefile'
Simple feature collection with 330 features and 9 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure all sf objects have the same CRS</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>adm0 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(adm0, <span class="dv">4326</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>adm1 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(adm1, <span class="dv">4326</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>adm2 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(adm2, <span class="dv">4326</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>adm3 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(adm3, <span class="dv">4326</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of all administrative boundaries</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>admin_boundaries <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">adm0 =</span> adm0, <span class="at">adm1 =</span> adm1, <span class="at">adm2 =</span> adm2, <span class="at">adm3 =</span> adm3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>conflict_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 42608 features and 30 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 92.1837 ymin: 9.9824 xmax: 100.3576 ymax: 27.5053
Geodetic CRS:  WGS 84
# A tibble: 42,608 × 31
   event_id_cnty event_date  year quarter time_precision disorder_type         
   &lt;chr&gt;         &lt;date&gt;     &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;                 
 1 MMR64313      2024-06-30  2024 2024-Q2              1 Political violence    
 2 MMR64320      2024-06-30  2024 2024-Q2              1 Political violence    
 3 MMR64321      2024-06-30  2024 2024-Q2              1 Political violence    
 4 MMR64322      2024-06-30  2024 2024-Q2              1 Strategic developments
 5 MMR64323      2024-06-30  2024 2024-Q2              1 Political violence    
 6 MMR64324      2024-06-30  2024 2024-Q2              1 Strategic developments
 7 MMR64325      2024-06-30  2024 2024-Q2              1 Political violence    
 8 MMR64326      2024-06-30  2024 2024-Q2              1 Political violence    
 9 MMR64328      2024-06-30  2024 2024-Q2              1 Political violence    
10 MMR64330      2024-06-30  2024 2024-Q2              1 Political violence    
# ℹ 42,598 more rows
# ℹ 25 more variables: event_type &lt;chr&gt;, sub_event_type &lt;chr&gt;, actor1 &lt;chr&gt;,
#   assoc_actor_1 &lt;chr&gt;, inter1 &lt;dbl&gt;, actor2 &lt;chr&gt;, assoc_actor_2 &lt;chr&gt;,
#   inter2 &lt;dbl&gt;, interaction &lt;dbl&gt;, civilian_targeting &lt;chr&gt;, region &lt;chr&gt;,
#   country &lt;chr&gt;, admin1 &lt;chr&gt;, admin2 &lt;chr&gt;, admin3 &lt;chr&gt;, location &lt;chr&gt;,
#   geo_precision &lt;dbl&gt;, source &lt;chr&gt;, source_scale &lt;chr&gt;, notes &lt;chr&gt;,
#   fatalities &lt;dbl&gt;, tags &lt;chr&gt;, timestamp &lt;dbl&gt;, population_best &lt;dbl&gt;, …</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a map of Myanmar showing the admin1 regions</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> adm1, <span class="fu">aes</span>(<span class="at">fill =</span> ST)) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>, <span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="dv">4326</span>)) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Myanmar ADM1 Boundaries"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"First-level administrative divisions"</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Data source: MIMU"</span>) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">name =</span> <span class="st">"States"</span>) <span class="sc">+</span>  <span class="co"># This ensures the legend shows state names</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>))  <span class="co"># Set max 3 per column, then side by side</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory Data Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a custom color palette for event types</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>event_types <span class="ot">&lt;-</span> <span class="fu">unique</span>(conflict_data<span class="sc">$</span>event_type)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>event_colors <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">viridis</span>(<span class="fu">length</span>(event_types)), event_types)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Overview map of conflict events</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>overview_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> adm1, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> conflict_data, <span class="fu">aes</span>(<span class="at">color =</span> event_type), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Overview of Conflict Events in Myanmar"</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Event Type"</span>) <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Temporal trend of events</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>temporal_trend <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(event_date) <span class="sc">%&gt;%</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> event_date, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Temporal Trend of Conflict Events"</span>,</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Number of Events"</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Distribution of event types</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>event_type_dist <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(event_type) <span class="sc">%&gt;%</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(event_type, n), <span class="at">y =</span> n, <span class="at">fill =</span> event_type)) <span class="sc">+</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> event_colors) <span class="sc">+</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Event Types"</span>,</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Event Type"</span>, <span class="at">y =</span> <span class="st">"Number of Events"</span>) <span class="sc">+</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Events heatmap</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>events_heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> adm1, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_2d</span>(<span class="at">data =</span> conflict_data, </span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">st_coordinates</span>(geometry)[,<span class="dv">1</span>], </span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>                      <span class="at">y =</span> <span class="fu">st_coordinates</span>(geometry)[,<span class="dv">2</span>],</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fill =</span> ..level..),</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>                  <span class="at">geom =</span> <span class="st">"polygon"</span>, </span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>() <span class="sc">+</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heatmap of Conflict Events"</span>,</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Density"</span>)</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Administrative region comparison</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>admin_comparison <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(admin1) <span class="sc">%&gt;%</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, n) <span class="sc">%&gt;%</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(admin1, n), <span class="at">y =</span> n, <span class="at">fill =</span> admin1)) <span class="sc">+</span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Administrative Regions by Number of Events"</span>,</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Administrative Region"</span>, <span class="at">y =</span> <span class="st">"Number of Events"</span>) <span class="sc">+</span></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a><span class="co">#Event type distribution for top 5 regions</span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>top_5_regions <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(admin1) <span class="sc">%&gt;%</span></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">5</span>, n) <span class="sc">%&gt;%</span></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(admin1)</span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>event_type_by_region <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(admin1 <span class="sc">%in%</span> top_5_regions) <span class="sc">%&gt;%</span></span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(admin1, event_type) <span class="sc">%&gt;%</span></span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(admin1) <span class="sc">%&gt;%</span></span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Event type distributions among the top 5 regions.</span></span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a>event_type_pies <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(event_type_by_region, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> prop, <span class="at">fill =</span> event_type)) <span class="sc">+</span></span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> admin1, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> event_colors) <span class="sc">+</span></span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Event Type Distribution in Top 5 Regions"</span>,</span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Event Type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Our analysis examines conflict events in Myanmar from January 2021 to June 2024. During this period, there was around 42,000 conflict events across the country. These events range from battles, violence against civilians to armed clashes, providing insight into the complex security situation in Myanmar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>overview_map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This map shows the distribution of conflict events across Myanmar. Each point represents an individual event, with colors indicating different types of events. Notice how events are not evenly distributed but tend to cluster in certain areas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>temporal_trend</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This graph shows how the number of conflict events has changed over time. Notice how the conflict in Myanmar shows a distinct pattern of escalation and stabilization.</p>
<p>The conflict intensity gradually increased from the beginning of 2021 before reaching its apex in the third to fourth quarter of 2021. Following the peak, the conflict settled into a relatively consistent level of activity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>event_type_dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>events_heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The heatmap reveals areas of high conflict concentration. Brighter areas indicate ‘hotspots’ where many events have occurred. The conflict is not evenly distributed across Myanmar. *</p>
<p>Key hotspots include:</p>
<p>1. Northern/Central Regions: Sagaing, Magway, Mandalay, and Shan</p>
<p>2. Southern Region: Yangon</p>
<p>Possible reasons for these hotspots:</p>
<ol type="1">
<li>Northern/Central Regions (Sagaing, Magway, Mandalay, and Shan):
<ul>
<li>The area represents a critical juncture between the military-controlled central corridor and the resistance-held peripheral regions.</li>
</ul></li>
<li>Southern Region (Yangon):
<ul>
<li>Yangon, as Myanmar’s largest city and former capital, is a crucial urban center with significant economic and political importance and is also a contested region.</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>admin_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>event_type_pies</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Our exploratory data analysis reveals clear patterns in the distribution of armed conflict across Myanmar from 2021 to 2024. The spatial distribution of fighting aligns closely with the geopolitical landscape of the country, particularly the contested areas where the Junta’s held territory intersects with regions controlled or influenced by rebel forces, as observed in the map by the Special Advisory Council for Myanmar above.</p>
<p>Key findings from our analysis include:</p>
<ol type="1">
<li><p><strong>Concentration in Contested Regions</strong>: The majority of conflict events are clustered in areas where control is disputed between the Junta and rebel groups. This pattern underscores the strategic importance of these regions and the intensity of the struggle for territorial control.</p></li>
<li><p><strong>Hotspots in Northern/Central Regions</strong>: The analysis identifies significant conflict activity in the following areas: Sagaing, Magway, Mandalay, and Shan.</p></li>
<li><p><strong>Southern Conflict Center</strong>: Yangon also emerges as a notable area of conflict.</p></li>
<li><p><strong>Relative Calm in Uncontested Areas</strong>: Regions that fall squarely within the undisputed territory of either the Junta or rebel groups show notably less conflict activity. This pattern aligns with the expectation that areas of clear control experience fewer armed confrontations.</p></li>
</ol>
</section>
</section>
<section id="first-order-spatial-temporal-patterns-analysis-understanding-conflict-trends-in-myanmar" class="level1">
<h1>First-order Spatial-Temporal Patterns Analysis: Understanding Conflict Trends in Myanmar</h1>
<p>To further investigate the spatial and temporal dynamics of conflict events in Myanmar, we employed a First-order Spatial-Temporal Point Patterns Analysis. This method allows us to visualize and quantify the distribution of conflict events across space and time, revealing patterns that may not be apparent from raw event data alone.</p>
<p><strong>Temporal Segmentation</strong></p>
<p>Building upon our initial analysis, we segmented the conflict event data into quarterly periods from Q1 2021 to Q2 2024. This temporal resolution provides a balance between granularity and the ability to discern broader trends, allowing us to track the evolution of conflict patterns over the study period.</p>
<p><strong>Handling Spatial Data Challenges (Duplicates)</strong></p>
<p>A common challenge in spatial point pattern analysis is the occurrence of multiple events at identical coordinates, often due to limitations in spatial precision of reporting. To address this, we applied a jittering technique where each point was slightly displaced in a random direction.</p>
<section id="kernel-density-estimation-kde" class="level2">
<h2 class="anchored" data-anchor-id="kernel-density-estimation-kde">Kernel Density Estimation (KDE)</h2>
<p>For each quarter, we performed Kernel Density Estimation to visualize the spatial concentration of conflict events.</p>
<p><strong>Standardization of Density Scales</strong></p>
<p>To ensure meaningful comparison of conflict intensity across different quarters, we standardized the density scales. This standardization ensures that color intensities represent the same conflict density across all temporal segments, facilitating direct visual comparison.</p>
<p><strong>Visualization</strong></p>
<p>An animation was created to display the sequence of quarterly KDE maps, allowing for intuitive comprehension of temporal trends in conflict distribution.</p>
<p>This methodology enables us to:</p>
<ol type="1">
<li><p>Identify persistent conflict hotspots across the study period.</p></li>
<li><p>Detect emerging or dissipating areas of conflict.</p></li>
<li><p>Visualize the spatial evolution of conflict intensity over time.</p></li>
<li><p>Compare conflict patterns across different quarters on a standardized scale.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create KDE for a specific quarter</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>create_kde <span class="ot">&lt;-</span> <span class="cf">function</span>(data, quarter, <span class="at">bw =</span> <span class="cn">NULL</span>) {</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  quarter_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(quarter <span class="sc">==</span> <span class="sc">!!</span>quarter)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert sf object to ppp object</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  window <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_bbox</span>(adm0))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  ppp_obj <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(quarter_data), <span class="at">W =</span> window)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply jittering to handle duplicated points</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  ppp_obj_jittered <span class="ot">&lt;-</span> <span class="fu">rjitter</span>(ppp_obj, <span class="at">retry =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">1</span>, <span class="at">drop =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute default bandwidth if not provided</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(bw)) {</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    bw <span class="ot">&lt;-</span> <span class="fu">bw.diggle</span>(ppp_obj_jittered)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute KDE</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  kde <span class="ot">&lt;-</span> <span class="fu">density.ppp</span>(ppp_obj_jittered, <span class="at">sigma =</span> bw.diggle, <span class="at">edge =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to raster</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">raster</span>(kde)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mask the raster with Myanmar boundary</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove data outside of Myanmar.</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  r_masked <span class="ot">&lt;-</span> <span class="fu">mask</span>(r, <span class="fu">as</span>(adm0, <span class="st">"Spatial"</span>))</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r_masked)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Get unique quarters</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>quarters <span class="ot">&lt;-</span> <span class="fu">unique</span>(conflict_data<span class="sc">$</span>quarter)</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create KDE for each quarter</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>kde_layers <span class="ot">&lt;-</span> <span class="fu">lapply</span>(quarters, <span class="cf">function</span>(q) {</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">create_kde</span>(conflict_data, q)</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">"Error in quarter"</span>, q, <span class="st">":"</span>, e<span class="sc">$</span>message))</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove any NULL elements (quarters where KDE failed)</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>kde_layers <span class="ot">&lt;-</span> kde_layers[<span class="sc">!</span><span class="fu">sapply</span>(kde_layers, is.null)]</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Name the layers</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(kde_layers) <span class="ot">&lt;-</span> quarters[<span class="sc">!</span><span class="fu">sapply</span>(kde_layers, is.null)]</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary of KDE layers</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(kde_layers))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Length Class       Mode
2024-Q2 16384  RasterLayer S4  
2024-Q1 16384  RasterLayer S4  
2023-Q4 16384  RasterLayer S4  
2023-Q3 16384  RasterLayer S4  
2023-Q2 16384  RasterLayer S4  
2023-Q1 16384  RasterLayer S4  
2022-Q4 16384  RasterLayer S4  
2022-Q3 16384  RasterLayer S4  
2022-Q2 16384  RasterLayer S4  
2022-Q1 16384  RasterLayer S4  
2021-Q4 16384  RasterLayer S4  
2021-Q3 16384  RasterLayer S4  
2021-Q2 16384  RasterLayer S4  
2021-Q1 16384  RasterLayer S4  </code></pre>
</div>
</div>
</section>
<section id="visualization-of-the-various-kde-maps-by-quarter" class="level2">
<h2 class="anchored" data-anchor-id="visualization-of-the-various-kde-maps-by-quarter">Visualization of the various KDE maps by quarter</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get the lowest maximum density across all KDE layers</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>get_lowest_max_density <span class="ot">&lt;-</span> <span class="cf">function</span>(kde_layers) {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  max_densities <span class="ot">&lt;-</span> <span class="fu">sapply</span>(kde_layers, <span class="cf">function</span>(layer) {</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(<span class="fu">values</span>(layer), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">min</span>(max_densities)))</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the density range with the lowest maximum</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>density_range <span class="ot">&lt;-</span> <span class="fu">get_lowest_max_density</span>(kde_layers)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot a single KDE layer with fixed density scale</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>plot_kde_layer <span class="ot">&lt;-</span> <span class="cf">function</span>(kde_layer, quarter, admin_boundary, density_range) {</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert raster to data frame for ggplot</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  kde_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(kde_layer, <span class="at">xy =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">density =</span> layer)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the plot</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_raster</span>(<span class="at">data =</span> kde_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> density)) <span class="sc">+</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> admin_boundary, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>                         <span class="at">limits =</span> density_range,</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">oob =</span> scales<span class="sc">::</span>squish) <span class="sc">+</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"KDE for"</span>, quarter),</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Longitude"</span>, <span class="at">y =</span> <span class="st">"Latitude"</span>, <span class="at">fill =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>()</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all KDE layers with fixed density scale</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>kde_plots <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(kde_layers), <span class="cf">function</span>(i) {</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_kde_layer</span>(kde_layers[[i]], <span class="fu">names</span>(kde_layers)[i], adm0, density_range)</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plots</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (plot <span class="cf">in</span> kde_plots) {</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(plot)</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-13-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-13-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-13-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-13-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-13-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-13-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-13-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-13-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-13-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-13-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-13-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The maps above shows the “heat” of conflict events in Myanmar for a specific three-month period (quarter).</p>
<ul>
<li><p>Red areas are “conflict hotspots” with many events close together.</p></li>
<li><p>The brighter the color, the more concentrated the conflict.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to convert a single KDE layer to a data frame</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>kde_to_df <span class="ot">&lt;-</span> <span class="cf">function</span>(kde_layer, quarter) {</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(kde_layer, <span class="at">xy =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">density =</span> layer) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">quarter =</span> quarter)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert all KDE layers to a single data frame</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>kde_df <span class="ot">&lt;-</span> <span class="fu">map2_dfr</span>(kde_layers, <span class="fu">names</span>(kde_layers), kde_to_df)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the base plot</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="at">data =</span> kde_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> density)) <span class="sc">+</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> adm0, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> density_range,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">oob =</span> scales<span class="sc">::</span>squish) <span class="sc">+</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Conflict Density in Myanmar: {closest_state}"</span>,</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Longitude"</span>, <span class="at">y =</span> <span class="st">"Latitude"</span>, <span class="at">fill =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>()</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="co"># The following code creates the animation, render it and saves it as a gif. It will be commented out for brevity.</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Add animation</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="co">#animated_plot &lt;- p +</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="co"># transition_states(quarter,</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="co">#                    transition_length = 2,</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="co">#                    state_length = 3) +</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="co">#  ease_aes('cubic-in-out')</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Render the animation</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="co">#anim &lt;- animate(animated_plot, nframes = 200, fps = 10, width = 800, height = 600, renderer = gifski_renderer())</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the animation</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="co">#anim_save("myanmar_conflict_density_slideshow_kde.gif", anim)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="animation-of-the-conflict-density-in-myanmar-over-time" class="level2">
<h2 class="anchored" data-anchor-id="animation-of-the-conflict-density-in-myanmar-over-time">Animation of the Conflict Density in Myanmar over Time</h2>
<p><img src="myanmar_conflict_density_slideshow_kde.gif" class="img-fluid"></p>
<p>This animation shows how conflict hotspots evolved in Myanmar from early 2021 to mid-2024. Each frame represents a three-month period (quarter), with warmer colors (red and orange) indicating areas of high conflict concentration and cooler colors (blue and green) showing areas of lower conflict activity.</p>
<p>Key observations:</p>
<ol type="1">
<li><p><strong>Central Concentration</strong>: Notice how the conflicts are consistently concentrated in the middle area of Myanmar throughout the entire period. This pattern supports our previous analysis and highlights the persistent nature of conflicts in this region.</p></li>
<li><p><strong>Relative Calm in Peripheries</strong>: The peripheral areas, particularly the far north, far south and far east generally show lower conflict intensity.</p></li>
</ol>
</section>
<section id="spatio-temporal-kernel-density-estimation" class="level2">
<h2 class="anchored" data-anchor-id="spatio-temporal-kernel-density-estimation">Spatio-Temporal kernel density estimation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for STKDE</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(conflict_data)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(conflict_data<span class="sc">$</span>event_date <span class="sc">-</span> <span class="fu">min</span>(conflict_data<span class="sc">$</span>event_date))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create observation window for the entire region</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>window_full <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_bbox</span>(adm0))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ppp object</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>ppp_full <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(coords, <span class="at">W =</span> window_full)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute bandwidths</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>h_spatial <span class="ot">&lt;-</span> <span class="fu">bw.ppl</span>(ppp_full)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>h_temporal <span class="ot">&lt;-</span> <span class="fu">bw.SJ</span>(t)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform STKDE</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>stkde_result <span class="ot">&lt;-</span> <span class="fu">spattemp.density</span>(ppp_full, t, <span class="at">tlim =</span> <span class="fu">range</span>(t),</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">h =</span> <span class="fu">c</span>(h_spatial, h_temporal))</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary of STKDE result</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(stkde_result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatiotemporal Kernel Density Estimate

Bandwidths
  h = 0.022 (spatial)
  lambda = 13.2077 (temporal)

No. of observations
  42608 

Spatial bound
  Type: rectangle
  2D enclosure: [92.1721, 101.17] x [9.696844, 28.54554]

Temporal bound
  [0, 1276]

Evaluation
  128 x 128 x 1277 trivariate lattice
  Density range: [0, 0.006236424]
NULL</code></pre>
</div>
</div>
</section>
</section>
<section id="second-order-spatial-temporal-patterns-analysis" class="level1">
<h1>Second-order Spatial-Temporal Patterns Analysis</h1>
<p>The second-order spatial-temporal patterns analysis concentrates on a select group of key regions, strategically chosen to provide in-depth insights into the most critical areas of conflict, namely <strong>Sagaing</strong>, <strong>Magway</strong>, <strong>Mandalay</strong>,<strong>Yangon</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the regions of interest</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>regions_of_interest <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Sagaing"</span>, <span class="st">"Magway"</span>, <span class="st">"Mandalay"</span>,<span class="st">"Yangon"</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the specified regions from adm1</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>study_area <span class="ot">&lt;-</span> adm1 <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">%in%</span> regions_of_interest)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary of the study area</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(study_area))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    OBJECTID          ST              ST_PCODE            ST_RG          
 Min.   : 8.00   Length:4           Length:4           Length:4          
 1st Qu.: 8.75   Class :character   Class :character   Class :character  
 Median :11.00   Mode  :character   Mode  :character   Mode  :character  
 Mean   :12.00                                                           
 3rd Qu.:14.25                                                           
 Max.   :18.00                                                           
    ST_MMR             PCode_V             geometry
 Length:4           Min.   :9.4   MULTIPOLYGON :4  
 Class :character   1st Qu.:9.4   epsg:4326    :0  
 Mode  :character   Median :9.4   +proj=long...:0  
                    Mean   :9.4                    
                    3rd Qu.:9.4                    
                    Max.   :9.4                    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the study area to visualize it</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> adm1, <span class="at">fill =</span> <span class="st">"lightgrey"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> study_area, <span class="fu">aes</span>(<span class="at">fill =</span> ST), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Study Area: Selected Regions in Myanmar"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Region"</span>) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="central-regions-analysis" class="level2">
<h2 class="anchored" data-anchor-id="central-regions-analysis">Central Regions Analysis</h2>
<section id="sagaing" class="level3">
<h3 class="anchored" data-anchor-id="sagaing">Sagaing</h3>
<section id="g-function" class="level4">
<h4 class="anchored" data-anchor-id="g-function">G-Function</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Sagaing region</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>sagaing <span class="ot">&lt;-</span> adm1 <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">==</span> <span class="st">"Sagaing"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Print basic information about Sagaing</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sagaing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 93.94619 ymin: 21.57596 xmax: 97.0669 ymax: 27.37205
Geodetic CRS:  WGS 84
  OBJECTID      ST ST_PCODE  ST_RG         ST_MMR PCode_V
1       13 Sagaing   MMR005 Region စစ်ကိုင်းတိုင်းဒေသကြီး     9.4
                        geometry
1 MULTIPOLYGON (((96.72824 27...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Sagaing to visualize it</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> adm1, <span class="at">fill =</span> <span class="st">"lightgrey"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sagaing, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sagaing Region in Myanmar"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter conflict data for Sagaing and jitter the coordinates</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>conflict_sagaing <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(sagaing) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ST)) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_jitter</span>()  <span class="co"># Small jitter amount, adjust if needed</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create observation window for Sagaing</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>window_sagaing <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_bbox</span>(sagaing))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert jittered conflict points to ppp object</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>conflict_ppp_sagaing <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(conflict_sagaing), <span class="at">W =</span> window_sagaing)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute G-function estimation</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>g_est_sagaing <span class="ot">&lt;-</span> <span class="fu">Gest</span>(conflict_ppp_sagaing, <span class="at">correction =</span> <span class="st">"border"</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the G-function</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g_est_sagaing, <span class="at">main =</span> <span class="st">"G-function for Conflict Events in Sagaing"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary of G-function estimation</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(g_est_sagaing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       r                theo              rs        
 Min.   :0.00000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.01929   1st Qu.:0.5130   1st Qu.:0.9782  
 Median :0.03859   Median :0.9438   Median :0.9945  
 Mean   :0.03859   Mean   :0.7383   Mean   :0.9432  
 3rd Qu.:0.05788   3rd Qu.:0.9985   3rd Qu.:0.9969  
 Max.   :0.07718   Max.   :1.0000   Max.   :0.9977  </code></pre>
</div>
</div>
<p>This G-function plot provides strong evidence that conflict events in Sagaing are not randomly distributed but are instead highly clustered, particularly at very short distances. This could suggest that conflicts tend to occur in specific hotspots or that one conflict event might trigger others in very close proximity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Monte Carlo test</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>G_sagaing_env <span class="ot">&lt;-</span> <span class="fu">envelope</span>(conflict_ppp_sagaing, <span class="at">fun =</span> Gest, <span class="at">nsim =</span> <span class="dv">999</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">global =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10.........20.........30.........40.........50.........60..
.......70.........80.........90.........100.........110.........120.........130
.........140.........150.........160.........170.........180.........190........
.200.........210.........220.........230.........240.........250.........260......
...270.........280.........290.........300.........310.........320.........330....
.....340.........350.........360.........370.........380.........390.........400..
.......410.........420.........430.........440.........450.........460.........470
.........480.........490.........500.........510.........520.........530........
.540.........550.........560.........570.........580.........590.........600......
...610.........620.........630.........640.........650.........660.........670....
.....680.........690.........700.........710.........720.........730.........740..
.......750.........760.........770.........780.........790.........800.........810
.........820.........830.........840.........850.........860.........870........
.880.........890.........900.........910.........920.........930.........940......
...950.........960.........970.........980.........990........
999.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G_sagaing_env, <span class="at">main =</span> <span class="st">"Monte Carlo Test: G-function for Conflict Events in Sagaing"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results of the test</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(G_sagaing_env)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simultaneous critical envelopes for G(r)
and observed value for 'conflict_ppp_sagaing'
Edge correction: "km"
Obtained from 999 simulations of CSR
Envelope based on maximum deviation of G(r) from null value for CSR (known 
exactly)
Alternative: two.sided
Significance level of simultaneous Monte Carlo test: 1/1000 = 0.001
...........................................................
     Math.label     Description                            
r    r              distance argument r                    
obs  hat(G)[obs](r) observed value of G(r) for data pattern
theo G[theo](r)     theoretical value of G(r) for CSR      
lo   hat(G)[lo](r)  lower critical boundary for G(r)       
hi   hat(G)[hi](r)  upper critical boundary for G(r)       
...........................................................
Default plot formula:  .~r
where "." stands for 'obs', 'theo', 'hi', 'lo'
Columns 'lo' and 'hi' will be plotted as shading (by default)
Recommended range of argument r: [0, 0.0097982]
Available range of argument r: [0, 0.0097982]</code></pre>
</div>
</div>
<p>This Monte Carlo test provides strong evidence that conflict events in Sagaing are significantly more clustered than would be expected by chance, particularly at shorter distances.</p>
</section>
<section id="l-function" class="level4">
<h4 class="anchored" data-anchor-id="l-function">L-Function</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate L-function</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>L_sagaing <span class="ot">&lt;-</span> <span class="fu">Lest</span>(conflict_ppp_sagaing, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot L-function</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_sagaing, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">main =</span> <span class="st">"L-function for Conflict Events in Sagaing"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This L-function analysis strongly supports the conclusion that conflict events in Sagaing are significantly clustered, with the clustering being particularly intense at shorter distances but persisting across larger scales as well. This pattern deviates markedly from what would be expected if the events were randomly distributed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Monte Carlo test with L-function</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>L_sagaing_env <span class="ot">&lt;-</span> <span class="fu">envelope</span>(conflict_ppp_sagaing, <span class="at">fun =</span> Lest, <span class="at">nsim =</span> <span class="dv">999</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">global =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10 [4:53 remaining] .........20 [4:52 remaining] ...
......30 [4:46 remaining] .........40 [4:40 remaining] .........50 [4:36 remaining] ..
.......60 [4:45 remaining] .........70 [4:40 remaining] .........80 [4:40 remaining] .
........90 [4:37 remaining] .........100 [4:34 remaining] .........110
 [4:29 remaining] .........120 [4:27 remaining] .........130 [4:23 remaining] .........
140 [4:19 remaining] .........150 [4:16 remaining] .........160 [4:13 remaining] ........
.170 [4:10 remaining] .........180 [4:08 remaining] .........190 [4:05 remaining] .......
..200 [4:01 remaining] .........210 [3:58 remaining] .........220 [3:55 remaining] ......
...230 [3:51 remaining] .........240 [3:47 remaining] .........250 [3:44 remaining] .....
....260 [3:40 remaining] .........270 [3:37 remaining] .........280 [3:34 remaining] ....
.....290 [3:31 remaining] .........300 [3:28 remaining] .........310 [3:25 remaining] ...
......320 [3:22 remaining] .........330 [3:19 remaining] .........340 [3:16 remaining] ..
.......350 [3:13 remaining] .........360 [3:09 remaining] .........370 [3:06 remaining] .
........380 [3:03 remaining] .........390 [3:00 remaining] .........400
 [2:57 remaining] .........410 [2:54 remaining] .........420 [2:51 remaining] .........
430 [2:48 remaining] .........440 [2:45 remaining] .........450 [2:42 remaining] ........
.460 [2:38 remaining] .........470 [2:35 remaining] .........480 [2:32 remaining] .......
..490 [2:29 remaining] .........500 [2:26 remaining] .........510 [2:23 remaining] ......
...520 [2:20 remaining] .........530 [2:17 remaining] .........540 [2:14 remaining] .....
....550 [2:11 remaining] .........560 [2:08 remaining] .........570 [2:05 remaining] ....
.....580 [2:02 remaining] .........590 [1:59 remaining] .........600 [1:56 remaining] ...
......610 [1:53 remaining] .........620 [1:51 remaining] .........630 [1:48 remaining] ..
.......640 [1:45 remaining] .........650 [1:42 remaining] .........660 [1:39 remaining] .
........670 [1:36 remaining] .........680 [1:33 remaining] .........690
 [1:30 remaining] .........700 [1:27 remaining] .........710 [1:24 remaining] .........
720 [1:21 remaining] .........730 [1:18 remaining] .........740 [1:15 remaining] ........
.750 [1:12 remaining] .........760 [1:09 remaining] .........770 [1:06 remaining] .......
..780 [1:04 remaining] .........790 [1:01 remaining] .........800 [58 sec remaining] ......
...810 [55 sec remaining] .........820 [52 sec remaining] .........830 [49 sec remaining] .....
....840 [46 sec remaining] .........850 [43 sec remaining] .........860 [40 sec remaining] ....
.....870 [37 sec remaining] .........880 [34 sec remaining] .........890 [32 sec remaining] ...
......900 [29 sec remaining] .........910 [26 sec remaining] .........920 [23 sec remaining] ..
.......930 [20 sec remaining] .........940 [17 sec remaining] .........950 [14 sec remaining] .
........960 [11 sec remaining] .........970 [8 sec remaining] .........980
 [5 sec remaining] .........990 [3 sec remaining] ........
999.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Monte Carlo test results</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_sagaing_env, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">main =</span> <span class="st">"Monte Carlo Test: L-function for Conflict Events in Sagaing"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results of the test</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(L_sagaing_env)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simultaneous critical envelopes for L(r)
and observed value for 'conflict_ppp_sagaing'
Edge correction: "iso"
Obtained from 999 simulations of CSR
Envelope based on maximum deviation of L(r) from null value for CSR (known 
exactly)
Alternative: two.sided
Significance level of simultaneous Monte Carlo test: 1/1000 = 0.001
...........................................................
     Math.label     Description                            
r    r              distance argument r                    
obs  hat(L)[obs](r) observed value of L(r) for data pattern
theo L[theo](r)     theoretical value of L(r) for CSR      
lo   hat(L)[lo](r)  lower critical boundary for L(r)       
hi   hat(L)[hi](r)  upper critical boundary for L(r)       
...........................................................
Default plot formula:  .~r
where "." stands for 'obs', 'theo', 'hi', 'lo'
Columns 'lo' and 'hi' will be plotted as shading (by default)
Recommended range of argument r: [0, 0.7193]
Available range of argument r: [0, 0.7193]</code></pre>
</div>
</div>
</section>
<section id="l-function-over-time" class="level4">
<h4 class="anchored" data-anchor-id="l-function-over-time">L-Function over time</h4>
<p>To maintain brevity and avoid overwhelming the report with excessive imagery, the code segment demonstrating the temporal evolution of the L-Function has been set to <code>eval:false</code>. This setting suppresses the generation and display of multiple images in the final report.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Sagaing region</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>sagaing <span class="ot">&lt;-</span> adm1 <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">==</span> <span class="st">"Sagaing"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter conflict data for Sagaing and jitter the coordinates</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>conflict_sagaing <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(sagaing) <span class="sc">%&gt;%</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ST)) <span class="sc">%&gt;%</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_jitter</span>()</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create observation window for Sagaing</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>window_sagaing <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_bbox</span>(sagaing))</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to analyze a single quarter</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>analyze_quarter <span class="ot">&lt;-</span> <span class="cf">function</span>(data, quarter) {</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  conflict_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(data), <span class="at">W =</span> window_sagaing)</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    g_est <span class="ot">&lt;-</span> <span class="fu">Gest</span>(conflict_ppp, <span class="at">correction =</span> <span class="st">"border"</span>)</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>    l_est <span class="ot">&lt;-</span> <span class="fu">Lest</span>(conflict_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>    g_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(g_est, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"G-function for Sagaing -"</span>, quarter))</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>    l_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(l_est, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"L-function for Sagaing -"</span>, quarter))</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">g_plot =</span> g_plot, <span class="at">l_plot =</span> l_plot, <span class="at">message =</span> <span class="cn">NULL</span>))</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Lack of entry within the time period:"</span>, quarter))</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform analysis for each quarter</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>quarterly_results <span class="ot">&lt;-</span> conflict_sagaing <span class="sc">%&gt;%</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(quarter) <span class="sc">%&gt;%</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_map</span>(<span class="sc">~</span> <span class="fu">analyze_quarter</span>(.x, .y<span class="sc">$</span>quarter))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="spatio-temporal-kernel-density-estimation-1" class="level4">
<h4 class="anchored" data-anchor-id="spatio-temporal-kernel-density-estimation-1"><strong>Spatio-Temporal kernel density estimation</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Sagaing region</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>sagaing <span class="ot">&lt;-</span> adm1 <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">==</span> <span class="st">"Sagaing"</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter conflict data for Sagaing and jitter the coordinates</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>conflict_sagaing <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(sagaing) <span class="sc">%&gt;%</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ST)) <span class="sc">%&gt;%</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_jitter</span>()</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create observation window for Sagaing</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>window_sagaing <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_bbox</span>(sagaing))</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for STKDE</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(conflict_sagaing)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(conflict_sagaing<span class="sc">$</span>event_date <span class="sc">-</span> <span class="fu">min</span>(conflict_sagaing<span class="sc">$</span>event_date))</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ppp object</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>ppp_sagaing <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(coords, <span class="at">W =</span> window_sagaing)</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute bandwidths</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>h_spatial <span class="ot">&lt;-</span> <span class="fu">bw.ppl</span>(ppp_sagaing)</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>h_temporal <span class="ot">&lt;-</span> <span class="fu">bw.SJ</span>(t)</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform STKDE</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>stkde_result <span class="ot">&lt;-</span> <span class="fu">spattemp.density</span>(ppp_sagaing, t, <span class="at">tlim =</span> <span class="fu">range</span>(t),</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">h =</span> <span class="fu">c</span>(h_spatial, h_temporal))</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Commented out the plotting to save space.</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot STKDE result</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(stkde_result, main = "STKDE for Sagaing Region")</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and plot time slices</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="co">#times &lt;- seq(min(t), max(t), length.out = 5)</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow = c(2, 3), mar = c(2, 2, 2, 2))</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a><span class="co">#for(time in times) {</span></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a><span class="co">#  slice &lt;- cut(stkde_result, t = time)</span></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a><span class="co">#  plot(slice, main = paste("STKDE at time", round(time, 2)))</span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary of STKDE result</span></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(stkde_result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatiotemporal Kernel Density Estimate

Bandwidths
  h = 0.0451 (spatial)
  lambda = 21.4746 (temporal)

No. of observations
  11128 

Spatial bound
  Type: rectangle
  2D enclosure: [93.94619, 97.0669] x [21.57596, 27.37205]

Temporal bound
  [0, 1264]

Evaluation
  128 x 128 x 1265 trivariate lattice
  Density range: [0, 0.006836297]
NULL</code></pre>
</div>
</div>
<p>The spatiotemporal analysis of conflict events in Sagaing reveals a highly clustered pattern of violence, both in space and time.</p>
<p>Over a period of about 3.5 years, 11,128 conflict events were recorded within a specific geographic area, averaging nearly 9 incidents per day.</p>
<p>Statistical tests, including G-function and L-function analyses, consistently demonstrate that this clustering is significantly more pronounced than would be expected from random distribution, with particularly intense clustering at shorter distances but persisting across larger scales.</p>
</section>
</section>
<section id="mandalay" class="level3">
<h3 class="anchored" data-anchor-id="mandalay">Mandalay</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Mandalay region</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>Mandalay <span class="ot">&lt;-</span> adm1 <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">==</span> <span class="st">"Mandalay"</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Print basic information about Mandalay</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Mandalay)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 94.82973 ymin: 20.19307 xmax: 96.89598 ymax: 23.68381
Geodetic CRS:  WGS 84
  OBJECTID       ST ST_PCODE  ST_RG          ST_MMR PCode_V
1        9 Mandalay   MMR010 Region မန္တလေးတိုင်းဒေသကြီး     9.4
                        geometry
1 MULTIPOLYGON (((96.14023 23...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Mandalay to visualize it</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> adm1, <span class="at">fill =</span> <span class="st">"lightgrey"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> Mandalay, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mandalay Region in Myanmar"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="g-function-1" class="level4">
<h4 class="anchored" data-anchor-id="g-function-1">G-Function</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter conflict data for Mandalay and jitter the coordinates</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>conflict_Mandalay <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(Mandalay) <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ST)) <span class="sc">%&gt;%</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_jitter</span>()  <span class="co"># Small jitter amount, adjust if needed</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create observation window for Mandalay</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>window_Mandalay <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_bbox</span>(Mandalay))</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert jittered conflict points to ppp object</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>conflict_ppp_Mandalay <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(conflict_Mandalay), <span class="at">W =</span> window_Mandalay)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute G-function estimation</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>g_est_Mandalay <span class="ot">&lt;-</span> <span class="fu">Gest</span>(conflict_ppp_Mandalay, <span class="at">correction =</span> <span class="st">"border"</span>)</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the G-function</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g_est_Mandalay, <span class="at">main =</span> <span class="st">"G-function for Conflict Events in Mandalay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary of G-function estimation</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(g_est_Mandalay)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       r                theo              rs        
 Min.   :0.00000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.02141   1st Qu.:0.5130   1st Qu.:0.9650  
 Median :0.04283   Median :0.9438   Median :0.9894  
 Mean   :0.04283   Mean   :0.7383   Mean   :0.9525  
 3rd Qu.:0.06424   3rd Qu.:0.9985   3rd Qu.:0.9944  
 Max.   :0.08565   Max.   :1.0000   Max.   :0.9972  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Monte Carlo test</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>G_Mandalay_env <span class="ot">&lt;-</span> <span class="fu">envelope</span>(conflict_ppp_Mandalay, <span class="at">fun =</span> Gest, <span class="at">nsim =</span> <span class="dv">999</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">global =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10.........20.........30.........40.........50.........60..
.......70.........80.........90.........100.........110.........120.........130
.........140.........150.........160.........170.........180.........190........
.200.........210.........220.........230.........240.........250.........260......
...270.........280.........290.........300.........310.........320.........330....
.....340.........350.........360.........370.........380.........390.........400..
.......410.........420.........430.........440.........450.........460.........470
.........480.........490.........500.........510.........520.........530........
.540.........550.........560.........570.........580.........590.........600......
...610.........620.........630.........640.........650.........660.........670....
.....680.........690.........700.........710.........720.........730.........740..
.......750.........760.........770.........780.........790.........800.........810
.........820.........830.........840.........850.........860.........870........
.880.........890.........900.........910.........920.........930.........940......
...950.........960.........970.........980.........990........
999.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G_Mandalay_env, <span class="at">main =</span> <span class="st">"Monte Carlo Test: G-function for Conflict Events in Mandalay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results of the test</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(G_Mandalay_env)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simultaneous critical envelopes for G(r)
and observed value for 'conflict_ppp_Mandalay'
Edge correction: "km"
Obtained from 999 simulations of CSR
Envelope based on maximum deviation of G(r) from null value for CSR (known 
exactly)
Alternative: two.sided
Significance level of simultaneous Monte Carlo test: 1/1000 = 0.001
...........................................................
     Math.label     Description                            
r    r              distance argument r                    
obs  hat(G)[obs](r) observed value of G(r) for data pattern
theo G[theo](r)     theoretical value of G(r) for CSR      
lo   hat(G)[lo](r)  lower critical boundary for G(r)       
hi   hat(G)[hi](r)  upper critical boundary for G(r)       
...........................................................
Default plot formula:  .~r
where "." stands for 'obs', 'theo', 'hi', 'lo'
Columns 'lo' and 'hi' will be plotted as shading (by default)
Recommended range of argument r: [0, 0.0083644]
Available range of argument r: [0, 0.0083644]</code></pre>
</div>
</div>
</section>
<section id="l-function-1" class="level4">
<h4 class="anchored" data-anchor-id="l-function-1">L-Function</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate L-function</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>L_Mandalay <span class="ot">&lt;-</span> <span class="fu">Lest</span>(conflict_ppp_Mandalay, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot L-function</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_Mandalay, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">main =</span> <span class="st">"L-function for Conflict Events in Mandalay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Monte Carlo test with L-function</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>L_Mandalay_env <span class="ot">&lt;-</span> <span class="fu">envelope</span>(conflict_ppp_Mandalay, <span class="at">fun =</span> Lest, <span class="at">nsim =</span> <span class="dv">999</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">global =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10.........20.........30.........40.........50.........60..
.......70.........80.........90.........100.........110.........120.........130
.........140.........150.........160.........170.........180.........190........
.200.........210.........220.........230.........240.........250.........260......
...270.........280.........290.........300.........310.........320.........330....
.....340.........350.........360.........370.........380.........390.........400..
.......410.........420.........430.........440.........450.........460.........470
.........480.........490.........500.........510.........520.........530........
.540.........550.........560.........570.........580.........590.........600......
...610.........620.........630.........640.........650.........660.........670....
.....680.........690.........700.........710.........720.........730.........740..
.......750.........760.........770.........780.........790.........800.........810
.........820.........830.........840.........850.........860.........870........
.880.........890.........900.........910.........920.........930.........940......
...950.........960.........970.........980.........990........
999.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Monte Carlo test results</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_Mandalay_env, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">main =</span> <span class="st">"Monte Carlo Test: L-function for Conflict Events in Mandalay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results of the test</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(L_Mandalay_env)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simultaneous critical envelopes for L(r)
and observed value for 'conflict_ppp_Mandalay'
Edge correction: "iso"
Obtained from 999 simulations of CSR
Envelope based on maximum deviation of L(r) from null value for CSR (known 
exactly)
Alternative: two.sided
Significance level of simultaneous Monte Carlo test: 1/1000 = 0.001
...........................................................
     Math.label     Description                            
r    r              distance argument r                    
obs  hat(L)[obs](r) observed value of L(r) for data pattern
theo L[theo](r)     theoretical value of L(r) for CSR      
lo   hat(L)[lo](r)  lower critical boundary for L(r)       
hi   hat(L)[hi](r)  upper critical boundary for L(r)       
...........................................................
Default plot formula:  .~r
where "." stands for 'obs', 'theo', 'hi', 'lo'
Columns 'lo' and 'hi' will be plotted as shading (by default)
Recommended range of argument r: [0, 0.51656]
Available range of argument r: [0, 0.51656]</code></pre>
</div>
</div>
</section>
<section id="l-function-over-time-1" class="level4">
<h4 class="anchored" data-anchor-id="l-function-over-time-1">L-Function over time</h4>
<p>Set to eval:false</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Mandalay region</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>mandalay <span class="ot">&lt;-</span> adm1 <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">==</span> <span class="st">"Mandalay"</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter conflict data for Mandalay and jitter the coordinates</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>conflict_mandalay <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(mandalay) <span class="sc">%&gt;%</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ST)) <span class="sc">%&gt;%</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_jitter</span>()</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create observation window for Mandalay</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>window_mandalay <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_bbox</span>(mandalay))</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to analyze a single quarter</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>analyze_quarter <span class="ot">&lt;-</span> <span class="cf">function</span>(data, quarter) {</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  conflict_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(data), <span class="at">W =</span> window_mandalay)</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>    g_est <span class="ot">&lt;-</span> <span class="fu">Gest</span>(conflict_ppp, <span class="at">correction =</span> <span class="st">"border"</span>)</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>    l_est <span class="ot">&lt;-</span> <span class="fu">Lest</span>(conflict_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>    g_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(g_est, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"G-function for Mandalay -"</span>, quarter))</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>    l_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(l_est, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"L-function for Mandalay -"</span>, quarter))</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">g_plot =</span> g_plot, <span class="at">l_plot =</span> l_plot, <span class="at">message =</span> <span class="cn">NULL</span>))</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Lack of entry within the time period:"</span>, quarter))</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform analysis for each quarter</span></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>quarterly_results <span class="ot">&lt;-</span> conflict_mandalay <span class="sc">%&gt;%</span></span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(quarter) <span class="sc">%&gt;%</span></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_map</span>(<span class="sc">~</span> <span class="fu">analyze_quarter</span>(.x, .y<span class="sc">$</span>quarter))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="spatio-temporal-kernel-density-estimation-2" class="level4">
<h4 class="anchored" data-anchor-id="spatio-temporal-kernel-density-estimation-2"><strong>Spatio-Temporal kernel density estimation</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mandalay Region</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>mandalay <span class="ot">&lt;-</span> adm1 <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">==</span> <span class="st">"Mandalay"</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter conflict data for Mandalay and jitter the coordinates</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>conflict_mandalay <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(mandalay) <span class="sc">%&gt;%</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ST)) <span class="sc">%&gt;%</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_jitter</span>()</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create observation window for Mandalay</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>window_mandalay <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_bbox</span>(mandalay))</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for STKDE</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(conflict_mandalay)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(conflict_mandalay<span class="sc">$</span>event_date <span class="sc">-</span> <span class="fu">min</span>(conflict_mandalay<span class="sc">$</span>event_date))</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ppp object</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>ppp_mandalay <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(coords, <span class="at">W =</span> window_mandalay)</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute bandwidths</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>h_spatial <span class="ot">&lt;-</span> <span class="fu">bw.ppl</span>(ppp_mandalay)</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>h_temporal <span class="ot">&lt;-</span> <span class="fu">bw.SJ</span>(t)</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform STKDE</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>stkde_result <span class="ot">&lt;-</span> <span class="fu">spattemp.density</span>(ppp_mandalay, t, <span class="at">tlim =</span> <span class="fu">range</span>(t),</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">h =</span> <span class="fu">c</span>(h_spatial, h_temporal))</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary of STKDE result</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(stkde_result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatiotemporal Kernel Density Estimate

Bandwidths
  h = 0.0075 (spatial)
  lambda = 26.5057 (temporal)

No. of observations
  3603 

Spatial bound
  Type: rectangle
  2D enclosure: [94.82973, 96.89598] x [20.19307, 23.68381]

Temporal bound
  [0, 1264]

Evaluation
  128 x 128 x 1265 trivariate lattice
  Density range: [0, 0.2306234]
NULL</code></pre>
</div>
</div>
<p>The analysis of conflict events in Mandalay reveals a significant pattern of spatial and temporal clustering. Over a period of approximately 3.5 years, 3,603 conflict events were recorded within a defined geographic area, averaging about 2.85 incidents per day.</p>
<p>Both the G-function and L-function analyses consistently demonstrate that this clustering is substantially more pronounced than would be expected from a random distribution, with particularly intense clustering at shorter distances but persisting across larger scales.</p>
<p>The spatiotemporal kernel density estimation further indicates the presence of specific hotspots within the region, with a wide density range suggesting significant variation in conflict concentration.</p>
</section>
</section>
<section id="magway" class="level3">
<h3 class="anchored" data-anchor-id="magway">Magway</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Magway region</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>Magway <span class="ot">&lt;-</span> adm1 <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">==</span> <span class="st">"Magway"</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Print basic information about Magway</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Magway)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 93.84551 ymin: 18.83204 xmax: 95.85919 ymax: 22.77128
Geodetic CRS:  WGS 84
  OBJECTID     ST ST_PCODE  ST_RG        ST_MMR PCode_V
1        8 Magway   MMR009 Region မကွေးတိုင်းဒေသကြီး     9.4
                        geometry
1 MULTIPOLYGON (((94.11699 22...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Magway to visualize it</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> adm1, <span class="at">fill =</span> <span class="st">"lightgrey"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> Magway, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Magway Region in Myanmar"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="g-function-2" class="level4">
<h4 class="anchored" data-anchor-id="g-function-2">G-Function</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Filter conflict data for Magway and jitter the coordinates</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>conflict_Magway <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(Magway) <span class="sc">%&gt;%</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ST)) <span class="sc">%&gt;%</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_jitter</span>()  <span class="co"># Small jitter amount, adjust if needed</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create observation window for Magway</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>window_Magway <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_bbox</span>(Magway))</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert jittered conflict points to ppp object</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>conflict_ppp_Magway <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(conflict_Magway), <span class="at">W =</span> window_Magway)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute G-function estimation</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>g_est_Magway <span class="ot">&lt;-</span> <span class="fu">Gest</span>(conflict_ppp_Magway, <span class="at">correction =</span> <span class="st">"border"</span>)</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the G-function</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g_est_Magway, <span class="at">main =</span> <span class="st">"G-function for Conflict Events in Magway"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary of G-function estimation</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(g_est_Magway)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       r                theo              rs        
 Min.   :0.00000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.02085   1st Qu.:0.5130   1st Qu.:0.9526  
 Median :0.04170   Median :0.9438   Median :0.9801  
 Mean   :0.04170   Mean   :0.7383   Mean   :0.9399  
 3rd Qu.:0.06255   3rd Qu.:0.9985   3rd Qu.:0.9899  
 Max.   :0.08340   Max.   :1.0000   Max.   :0.9966  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Monte Carlo test</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>G_Magway_env <span class="ot">&lt;-</span> <span class="fu">envelope</span>(conflict_ppp_Magway, <span class="at">fun =</span> Gest, <span class="at">nsim =</span> <span class="dv">999</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">global =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10.........20.........30.........40.........50.........60..
.......70.........80.........90.........100.........110.........120.........130
.........140.........150.........160.........170.........180.........190........
.200.........210.........220.........230.........240.........250.........260......
...270.........280.........290.........300.........310.........320.........330....
.....340.........350.........360.........370.........380.........390.........400..
.......410.........420.........430.........440.........450.........460.........470
.........480.........490.........500.........510.........520.........530........
.540.........550.........560.........570.........580.........590.........600......
...610.........620.........630.........640.........650.........660.........670....
.....680.........690.........700.........710.........720.........730.........740..
.......750.........760.........770.........780.........790.........800.........810
.........820.........830.........840.........850.........860.........870........
.880.........890.........900.........910.........920.........930.........940......
...950.........960.........970.........980.........990........
999.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G_Magway_env, <span class="at">main =</span> <span class="st">"Monte Carlo Test: G-function for Conflict Events in Magway"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results of the test</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(G_Magway_env)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simultaneous critical envelopes for G(r)
and observed value for 'conflict_ppp_Magway'
Edge correction: "km"
Obtained from 999 simulations of CSR
Envelope based on maximum deviation of G(r) from null value for CSR (known 
exactly)
Alternative: two.sided
Significance level of simultaneous Monte Carlo test: 1/1000 = 0.001
...........................................................
     Math.label     Description                            
r    r              distance argument r                    
obs  hat(G)[obs](r) observed value of G(r) for data pattern
theo G[theo](r)     theoretical value of G(r) for CSR      
lo   hat(G)[lo](r)  lower critical boundary for G(r)       
hi   hat(G)[hi](r)  upper critical boundary for G(r)       
...........................................................
Default plot formula:  .~r
where "." stands for 'obs', 'theo', 'hi', 'lo'
Columns 'lo' and 'hi' will be plotted as shading (by default)
Recommended range of argument r: [0, 0.0099367]
Available range of argument r: [0, 0.0099367]</code></pre>
</div>
</div>
</section>
<section id="l-function-2" class="level4">
<h4 class="anchored" data-anchor-id="l-function-2">L-Function</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate L-function</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>L_Magway <span class="ot">&lt;-</span> <span class="fu">Lest</span>(conflict_ppp_Magway, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot L-function</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_Magway, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">main =</span> <span class="st">"L-function for Conflict Events in Magway"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Monte Carlo test with L-function</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>L_Magway_env <span class="ot">&lt;-</span> <span class="fu">envelope</span>(conflict_ppp_Magway, <span class="at">fun =</span> Lest, <span class="at">nsim =</span> <span class="dv">999</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">global =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10.........20.........30.........40.........50.........60..
.......70.........80.........90.........100.........110.........120.........130
.........140.........150.........160.........170.........180.........190........
.200.........210.........220.........230.........240.........250.........260......
...270.........280.........290.........300.........310.........320.........330....
.....340.........350.........360.........370.........380.........390.........400..
.......410.........420.........430.........440.........450.........460.........470
.........480.........490.........500.........510.........520.........530........
.540.........550.........560.........570.........580.........590.........600......
...610.........620.........630.........640.........650.........660.........670....
.....680.........690.........700.........710.........720.........730.........740..
.......750.........760.........770.........780.........790.........800.........810
.........820.........830.........840.........850.........860.........870........
.880.........890.........900.........910.........920.........930.........940......
...950.........960.........970.........980.........990........
999.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Monte Carlo test results</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_Magway_env, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">main =</span> <span class="st">"Monte Carlo Test: L-function for Conflict Events in Magway"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results of the test</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(L_Magway_env)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simultaneous critical envelopes for L(r)
and observed value for 'conflict_ppp_Magway'
Edge correction: "iso"
Obtained from 999 simulations of CSR
Envelope based on maximum deviation of L(r) from null value for CSR (known 
exactly)
Alternative: two.sided
Significance level of simultaneous Monte Carlo test: 1/1000 = 0.001
...........................................................
     Math.label     Description                            
r    r              distance argument r                    
obs  hat(L)[obs](r) observed value of L(r) for data pattern
theo L[theo](r)     theoretical value of L(r) for CSR      
lo   hat(L)[lo](r)  lower critical boundary for L(r)       
hi   hat(L)[hi](r)  upper critical boundary for L(r)       
...........................................................
Default plot formula:  .~r
where "." stands for 'obs', 'theo', 'hi', 'lo'
Columns 'lo' and 'hi' will be plotted as shading (by default)
Recommended range of argument r: [0, 0.50342]
Available range of argument r: [0, 0.50342]</code></pre>
</div>
</div>
</section>
<section id="l-function-over-time-2" class="level4">
<h4 class="anchored" data-anchor-id="l-function-over-time-2">L-Function over time</h4>
<p>Set eval:false</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Magway region</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>magway <span class="ot">&lt;-</span> adm1 <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">==</span> <span class="st">"Magway"</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter conflict data for Magway and jitter the coordinates</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>conflict_magway <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(magway) <span class="sc">%&gt;%</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ST)) <span class="sc">%&gt;%</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_jitter</span>()</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create observation window for Magway</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>window_magway <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_bbox</span>(magway))</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to analyze a single quarter</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>analyze_quarter <span class="ot">&lt;-</span> <span class="cf">function</span>(data, quarter) {</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>  conflict_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(data), <span class="at">W =</span> window_magway)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>    g_est <span class="ot">&lt;-</span> <span class="fu">Gest</span>(conflict_ppp, <span class="at">correction =</span> <span class="st">"border"</span>)</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>    l_est <span class="ot">&lt;-</span> <span class="fu">Lest</span>(conflict_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>    g_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(g_est, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"G-function for Magway -"</span>, quarter))</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>    l_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(l_est, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"L-function for Magway -"</span>, quarter))</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">g_plot =</span> g_plot, <span class="at">l_plot =</span> l_plot, <span class="at">message =</span> <span class="cn">NULL</span>))</span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Lack of entry within the time period:"</span>, quarter))</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform analysis for each quarter</span></span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>quarterly_results <span class="ot">&lt;-</span> conflict_magway <span class="sc">%&gt;%</span></span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(quarter) <span class="sc">%&gt;%</span></span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_map</span>(<span class="sc">~</span> <span class="fu">analyze_quarter</span>(.x, .y<span class="sc">$</span>quarter))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="spatio-temporal-kernel-density-estimation-3" class="level4">
<h4 class="anchored" data-anchor-id="spatio-temporal-kernel-density-estimation-3"><strong>Spatio-Temporal kernel density estimation</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Magway Region</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>magway <span class="ot">&lt;-</span> adm1 <span class="sc">%&gt;%</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">==</span> <span class="st">"Magway"</span>)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter conflict data for Magway and jitter the coordinates</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>conflict_magway <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(magway) <span class="sc">%&gt;%</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ST)) <span class="sc">%&gt;%</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_jitter</span>()</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create observation window for Magway</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>window_magway <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_bbox</span>(magway))</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for STKDE</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(conflict_magway)</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(conflict_magway<span class="sc">$</span>event_date <span class="sc">-</span> <span class="fu">min</span>(conflict_magway<span class="sc">$</span>event_date))</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ppp object</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>ppp_magway <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(coords, <span class="at">W =</span> window_magway)</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute bandwidths</span></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>h_spatial <span class="ot">&lt;-</span> <span class="fu">bw.ppl</span>(ppp_magway)</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>h_temporal <span class="ot">&lt;-</span> <span class="fu">bw.SJ</span>(t)</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform STKDE</span></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>stkde_result <span class="ot">&lt;-</span> <span class="fu">spattemp.density</span>(ppp_magway, t, <span class="at">tlim =</span> <span class="fu">range</span>(t),</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">h =</span> <span class="fu">c</span>(h_spatial, h_temporal))</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary of STKDE result</span></span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(stkde_result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatiotemporal Kernel Density Estimate

Bandwidths
  h = 0.0136 (spatial)
  lambda = 29.4614 (temporal)

No. of observations
  4179 

Spatial bound
  Type: rectangle
  2D enclosure: [93.84551, 95.85919] x [18.83204, 22.77128]

Temporal bound
  [0, 1231]

Evaluation
  128 x 128 x 1232 trivariate lattice
  Density range: [0, 0.09105588]
NULL</code></pre>
</div>
</div>
<p>The analysis of conflict events in Magway reveals a significant pattern of spatial and temporal clustering over a period of approximately 3.4 years, with 4,179 recorded incidents averaging 3.4 events per day.</p>
<p>Both the G-function and L-function analyses consistently demonstrate that this clustering is substantially more pronounced than would be expected from a random distribution, with particularly intense clustering at shorter distances but persisting across larger scales.</p>
</section>
</section>
<section id="central-region-analysis" class="level3">
<h3 class="anchored" data-anchor-id="central-region-analysis">Central Region Analysis</h3>
<p>The analysis of conflict events across these three regions demonstrates a consistent pattern of significant spatial and temporal clustering, far exceeding what would be expected from random distribution.</p>
<p>Sagaing emerges as the most conflict-intensive area, with approximately 11,128 events over 3.5 years (about 9 events per day), followed by Magway with 4,179 events (3.4 per day), and Mandalay with 3,603 events (2.85 per day).</p>
<p>All three regions exhibit strong multi-scale clustering, with particularly intense clustering at shorter distances, indicating the presence of localized conflict hotspots as well as broader regional patterns.</p>
<p>The spatial analysis suggests that these conflict events are not uniformly distributed but are concentrated in specific geographic areas within each region, likely corresponding to strategic locations, population centers, or areas of contested control between Junta and rebel forces.</p>
<p>The spatiotemporal kernel density estimations for each region reveal significant variations in conflict intensity across space and time, suggesting the presence of dynamic hotspots that may shift or evolve. This could reflect the changing frontlines or areas of control between Junta and rebel forces, or the focus of military operations and resistance activities.</p>
<p>Given their status as critical border zones, the intense clustering and high frequency of conflict events in these regions likely reflect their strategic importance in the broader conflict. The patterns observed suggest a complex interplay of local and regional factors driving the conflict dynamics, potentially including control over key infrastructure, population centers, or resources.</p>
</section>
</section>
<section id="southern-region-yangon" class="level2">
<h2 class="anchored" data-anchor-id="southern-region-yangon">Southern-Region : Yangon</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Yangon region</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>Yangon <span class="ot">&lt;-</span> adm1 <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">==</span> <span class="st">"Yangon"</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Print basic information about Yangon</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Yangon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 93.35195 ymin: 14.04583 xmax: 96.82663 ymax: 17.79696
Geodetic CRS:  WGS 84
  OBJECTID     ST ST_PCODE  ST_RG        ST_MMR PCode_V
1       18 Yangon   MMR013 Region ရန်ကုန်တိုင်းဒေသကြီး     9.4
                        geometry
1 MULTIPOLYGON (((93.37067 14...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Yangon to visualize it</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> adm1, <span class="at">fill =</span> <span class="st">"lightgrey"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> Yangon, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Yangon Region in Myanmar"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="g-function-3" class="level3">
<h3 class="anchored" data-anchor-id="g-function-3">G-Function</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Filter conflict data for Yangon and jitter the coordinates</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>conflict_Yangon <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(Yangon) <span class="sc">%&gt;%</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ST)) <span class="sc">%&gt;%</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_jitter</span>()  <span class="co"># Small jitter amount, adjust if needed</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create observation window for Yangon</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>window_Yangon <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_bbox</span>(Yangon))</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert jittered conflict points to ppp object</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>conflict_ppp_Yangon <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(conflict_Yangon), <span class="at">W =</span> window_Yangon)</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute G-function estimation</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>g_est_Yangon <span class="ot">&lt;-</span> <span class="fu">Gest</span>(conflict_ppp_Yangon, <span class="at">correction =</span> <span class="st">"border"</span>)</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the G-function</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g_est_Yangon, <span class="at">main =</span> <span class="st">"G-function for Conflict Events in Yangon"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary of G-function estimation</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(g_est_Yangon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       r                theo              rs        
 Min.   :0.00000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.03383   1st Qu.:0.5130   1st Qu.:0.9908  
 Median :0.06767   Median :0.9438   Median :0.9977  
 Mean   :0.06767   Mean   :0.7383   Mean   :0.9887  
 3rd Qu.:0.10150   3rd Qu.:0.9985   3rd Qu.:0.9988  
 Max.   :0.13533   Max.   :1.0000   Max.   :0.9996  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Monte Carlo test</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>G_Yangon_env <span class="ot">&lt;-</span> <span class="fu">envelope</span>(conflict_ppp_Yangon, <span class="at">fun =</span> Gest, <span class="at">nsim =</span> <span class="dv">999</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">global =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10.........20.........30.........40.........50.........60..
.......70.........80.........90.........100.........110.........120.........130
.........140.........150.........160.........170.........180.........190........
.200.........210.........220.........230.........240.........250.........260......
...270.........280.........290.........300.........310.........320.........330....
.....340.........350.........360.........370.........380.........390.........400..
.......410.........420.........430.........440.........450.........460.........470
.........480.........490.........500.........510.........520.........530........
.540.........550.........560.........570.........580.........590.........600......
...610.........620.........630.........640.........650.........660.........670....
.....680.........690.........700.........710.........720.........730.........740..
.......750.........760.........770.........780.........790.........800.........810
.........820.........830.........840.........850.........860.........870........
.880.........890.........900.........910.........920.........930.........940......
...950.........960.........970.........980.........990........
999.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G_Yangon_env, <span class="at">main =</span> <span class="st">"Monte Carlo Test: G-function for Conflict Events in Yangon"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results of the test</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(G_Yangon_env)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simultaneous critical envelopes for G(r)
and observed value for 'conflict_ppp_Yangon'
Edge correction: "km"
Obtained from 999 simulations of CSR
Envelope based on maximum deviation of G(r) from null value for CSR (known 
exactly)
Alternative: two.sided
Significance level of simultaneous Monte Carlo test: 1/1000 = 0.001
...........................................................
     Math.label     Description                            
r    r              distance argument r                    
obs  hat(G)[obs](r) observed value of G(r) for data pattern
theo G[theo](r)     theoretical value of G(r) for CSR      
lo   hat(G)[lo](r)  lower critical boundary for G(r)       
hi   hat(G)[hi](r)  upper critical boundary for G(r)       
...........................................................
Default plot formula:  .~r
where "." stands for 'obs', 'theo', 'hi', 'lo'
Columns 'lo' and 'hi' will be plotted as shading (by default)
Recommended range of argument r: [0, 0.00079296]
Available range of argument r: [0, 0.00079296]</code></pre>
</div>
</div>
</section>
<section id="l-function-3" class="level3">
<h3 class="anchored" data-anchor-id="l-function-3">L-Function</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate L-function</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>L_Yangon <span class="ot">&lt;-</span> <span class="fu">Lest</span>(conflict_ppp_Yangon, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot L-function</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_Yangon, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">main =</span> <span class="st">"L-function for Conflict Events in Yangon"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Monte Carlo test with L-function</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>L_Yangon_env <span class="ot">&lt;-</span> <span class="fu">envelope</span>(conflict_ppp_Yangon, <span class="at">fun =</span> Lest, <span class="at">nsim =</span> <span class="dv">999</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">global =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10.........20.........30.........40.........50.........60..
.......70.........80.........90.........100.........110.........120.........130
.........140.........150.........160.........170.........180.........190........
.200.........210.........220.........230.........240.........250.........260......
...270.........280.........290.........300.........310.........320.........330....
.....340.........350.........360.........370.........380.........390.........400..
.......410.........420.........430.........440.........450.........460.........470
.........480.........490.........500.........510.........520.........530........
.540.........550.........560.........570.........580.........590.........600......
...610.........620.........630.........640.........650.........660.........670....
.....680.........690.........700.........710.........720.........730.........740..
.......750.........760.........770.........780.........790.........800.........810
.........820.........830.........840.........850.........860.........870........
.880.........890.........900.........910.........920.........930.........940......
...950.........960.........970.........980.........990........
999.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Monte Carlo test results</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_Yangon_env, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">main =</span> <span class="st">"Monte Carlo Test: L-function for Conflict Events in Yangon"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results of the test</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(L_Yangon_env)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simultaneous critical envelopes for L(r)
and observed value for 'conflict_ppp_Yangon'
Edge correction: "iso"
Obtained from 999 simulations of CSR
Envelope based on maximum deviation of L(r) from null value for CSR (known 
exactly)
Alternative: two.sided
Significance level of simultaneous Monte Carlo test: 1/1000 = 0.001
...........................................................
     Math.label     Description                            
r    r              distance argument r                    
obs  hat(L)[obs](r) observed value of L(r) for data pattern
theo L[theo](r)     theoretical value of L(r) for CSR      
lo   hat(L)[lo](r)  lower critical boundary for L(r)       
hi   hat(L)[hi](r)  upper critical boundary for L(r)       
...........................................................
Default plot formula:  .~r
where "." stands for 'obs', 'theo', 'hi', 'lo'
Columns 'lo' and 'hi' will be plotted as shading (by default)
Recommended range of argument r: [0, 0.86867]
Available range of argument r: [0, 0.86867]</code></pre>
</div>
</div>
</section>
<section id="l-function-over-time-3" class="level3">
<h3 class="anchored" data-anchor-id="l-function-over-time-3">L-Function over time</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Yangon region</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>yangon <span class="ot">&lt;-</span> adm1 <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">==</span> <span class="st">"Yangon"</span>)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter conflict data for Yangon and jitter the coordinates</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>conflict_yangon <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(yangon) <span class="sc">%&gt;%</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ST)) <span class="sc">%&gt;%</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_jitter</span>()</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create observation window for Yangon</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>window_yangon <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_bbox</span>(yangon))</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to analyze a single quarter</span></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>analyze_quarter <span class="ot">&lt;-</span> <span class="cf">function</span>(data, quarter) {</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>  conflict_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(data), <span class="at">W =</span> window_yangon)</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>    g_est <span class="ot">&lt;-</span> <span class="fu">Gest</span>(conflict_ppp, <span class="at">correction =</span> <span class="st">"border"</span>)</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>    l_est <span class="ot">&lt;-</span> <span class="fu">Lest</span>(conflict_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>    g_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(g_est, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"G-function for Yangon -"</span>, quarter))</span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>    l_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(l_est, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"L-function for Yangon -"</span>, quarter))</span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">g_plot =</span> g_plot, <span class="at">l_plot =</span> l_plot, <span class="at">message =</span> <span class="cn">NULL</span>))</span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Lack of entry within the time period:"</span>, quarter))</span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform analysis for each quarter</span></span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>quarterly_results <span class="ot">&lt;-</span> conflict_yangon <span class="sc">%&gt;%</span></span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(quarter) <span class="sc">%&gt;%</span></span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_map</span>(<span class="sc">~</span> <span class="fu">analyze_quarter</span>(.x, .y<span class="sc">$</span>quarter))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="spatio-temporal-kernel-density-estimation-4" class="level3">
<h3 class="anchored" data-anchor-id="spatio-temporal-kernel-density-estimation-4">Spatio-Temporal kernel density estimation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Yangon Region</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>yangon <span class="ot">&lt;-</span> adm1 <span class="sc">%&gt;%</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">==</span> <span class="st">"Yangon"</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter conflict data for Yangon and jitter the coordinates</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>conflict_yangon <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(yangon) <span class="sc">%&gt;%</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ST)) <span class="sc">%&gt;%</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_jitter</span>()</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create observation window for Yangon</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>window_yangon <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_bbox</span>(yangon))</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for STKDE</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(conflict_yangon)</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(conflict_yangon<span class="sc">$</span>event_date <span class="sc">-</span> <span class="fu">min</span>(conflict_yangon<span class="sc">$</span>event_date))</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ppp object</span></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>ppp_yangon <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(coords, <span class="at">W =</span> window_yangon)</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute bandwidths</span></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>h_spatial <span class="ot">&lt;-</span> <span class="fu">bw.ppl</span>(ppp_yangon)</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>h_temporal <span class="ot">&lt;-</span> <span class="fu">bw.SJ</span>(t)</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform STKDE</span></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>stkde_result <span class="ot">&lt;-</span> <span class="fu">spattemp.density</span>(ppp_yangon, t, <span class="at">tlim =</span> <span class="fu">range</span>(t),</span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">h =</span> <span class="fu">c</span>(h_spatial, h_temporal))</span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary of STKDE result</span></span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(stkde_result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatiotemporal Kernel Density Estimate

Bandwidths
  h = 0.004 (spatial)
  lambda = 21.4251 (temporal)

No. of observations
  2608 

Spatial bound
  Type: rectangle
  2D enclosure: [93.35195, 96.82663] x [14.04583, 17.79696]

Temporal bound
  [0, 1262]

Evaluation
  128 x 128 x 1263 trivariate lattice
  Density range: [0, 0.2711375]
NULL</code></pre>
</div>
</div>
<p>The analysis of conflict events in Yangon reveals a complex and intensely clustered pattern of violence over approximately 3.5 years, with 2,608 recorded incidents averaging 2.07 events per day.</p>
<p>Both the G-function and L-function analyses consistently demonstrate significant spatial clustering far exceeding what would be expected from random distribution, with particularly strong clustering at shorter and medium distances.</p>
<p>Comparing the conflict dynamics in Yangon with those of the central region (Sagaing, Mandalay, and Magway) reveals both similarities and distinct characteristics, highlighting the complex nature of the conflict across different parts of Myanmar:</p>
<ol type="1">
<li><p>Conflict Intensity:</p>
<ul>
<li>The Central Region experiences higher overall conflict intensity.</li>
</ul></li>
<li><p>Spatial Clustering:</p>
<ul>
<li><p>Both areas exhibit strong spatial clustering of conflict events, significantly deviating from random distribution.</p></li>
<li><p>Yangon shows particularly intense clustering at shorter and medium distances.</p></li>
<li><p>The central regions display strong multi-scale clustering, but without the pronounced peak seen in Yangon.</p></li>
</ul></li>
</ol>
<p>Yangon’s conflict pattern likely reflects complex urban dynamics, with potential concentrations in specific neighborhoods or districts of Myanmar’s largest city. The central regions’ patterns suggest a mix of urban and rural conflict zones, possibly reflecting the more diverse geography of these areas.</p>
</section>
</section>
</section>
<section id="visualization-of-conflict-density-using-openstreetmap" class="level1">
<h1>Visualization of Conflict Density Using OpenStreetMap</h1>
<p>Having completed our analysis using shapefiles, we now transition to a more realistic and detailed mapping approach by incorporating OpenStreetMap as the base layer for our Kernel Density Estimation (KDE) visualizations. This shift from abstract boundary representations to a comprehensive geographical context allows us to better understand the nuances of conflict distribution in Myanmar.</p>
<p>By overlaying our KDE results on this realistic backdrop, we can more effectively correlate conflict hotspots with actual geographical features, offering deeper insights into how the physical landscape and human geography of Myanmar influence conflict dynamics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to fetch OpenStreetMap base map</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>get_osm_map <span class="ot">&lt;-</span> <span class="cf">function</span>(bbox) {</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  osm_map <span class="ot">&lt;-</span> <span class="fu">read_osm</span>(bbox, <span class="at">type =</span> <span class="st">"osm"</span>, <span class="at">zoom =</span> <span class="cn">NULL</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(osm_map)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot a single KDE layer with tmap</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>plot_kde_tmap <span class="ot">&lt;-</span> <span class="cf">function</span>(kde_layer, quarter, admin_boundary, osm_map, density_range) {</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert raster to stars object</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>  kde_stars <span class="ot">&lt;-</span> <span class="fu">st_as_stars</span>(kde_layer)</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the threshold for visibility (e.g., top 20% of density values)</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>  threshold <span class="ot">&lt;-</span> <span class="fu">quantile</span>(kde_stars[[<span class="dv">1</span>]], <span class="fl">0.8</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set values below the threshold as NA for transparency</span></span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>  kde_stars[kde_stars <span class="sc">&lt;</span> threshold] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the tmap plot</span></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(osm_map) <span class="sc">+</span></span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_rgb</span>() <span class="sc">+</span></span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_shape</span>(kde_stars) <span class="sc">+</span></span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#FFCCCC"</span>, <span class="st">"#FF0000"</span>), </span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">title =</span> <span class="st">"Density"</span>,</span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">style =</span> <span class="st">"cont"</span>,</span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">breaks =</span> <span class="fu">c</span>(threshold, density_range[<span class="dv">2</span>]),</span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">midpoint =</span> <span class="cn">NA</span>,</span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.reverse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_shape</span>(admin_boundary) <span class="sc">+</span></span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"KDE for"</span>, quarter),</span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.outside.position =</span> <span class="st">"right"</span>)</span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the bounding box of Myanmar</span></span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true" tabindex="-1"></a>myanmar_bbox <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(adm0)</span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-40"><a href="#cb110-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Fetch OpenStreetMap base map</span></span>
<span id="cb110-41"><a href="#cb110-41" aria-hidden="true" tabindex="-1"></a>osm_map <span class="ot">&lt;-</span> <span class="fu">read_osm</span>(myanmar_bbox)</span>
<span id="cb110-42"><a href="#cb110-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-43"><a href="#cb110-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the density range</span></span>
<span id="cb110-44"><a href="#cb110-44" aria-hidden="true" tabindex="-1"></a>density_range <span class="ot">&lt;-</span> <span class="fu">get_lowest_max_density</span>(kde_layers)</span>
<span id="cb110-45"><a href="#cb110-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-46"><a href="#cb110-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all KDE layers with fixed density scale</span></span>
<span id="cb110-47"><a href="#cb110-47" aria-hidden="true" tabindex="-1"></a>kde_tmaps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(kde_layers), <span class="cf">function</span>(i) {</span>
<span id="cb110-48"><a href="#cb110-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_kde_tmap</span>(kde_layers[[i]], <span class="fu">names</span>(kde_layers)[i], adm0, osm_map, density_range)</span>
<span id="cb110-49"><a href="#cb110-49" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb110-50"><a href="#cb110-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-51"><a href="#cb110-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plots</span></span>
<span id="cb110-52"><a href="#cb110-52" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)  <span class="co"># Set tmap mode to static plotting</span></span>
<span id="cb110-53"><a href="#cb110-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (map <span class="cf">in</span> kde_tmaps) {</span>
<span id="cb110-54"><a href="#cb110-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(map)</span>
<span id="cb110-55"><a href="#cb110-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-45-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-45-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-45-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-45-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-45-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-45-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-45-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-45-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-45-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-45-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-45-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-45-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The diagrams below shows a different way of visualizing the conflict density with Open Street Map.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to fetch OpenStreetMap base map</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>get_osm_map <span class="ot">&lt;-</span> <span class="cf">function</span>(bbox) {</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  osm_map <span class="ot">&lt;-</span> <span class="fu">read_osm</span>(bbox, <span class="at">type =</span> <span class="st">"osm"</span>, <span class="at">zoom =</span> <span class="cn">NULL</span>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(osm_map)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot a single KDE layer with tmap</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>plot_kde_tmap <span class="ot">&lt;-</span> <span class="cf">function</span>(kde_layer, quarter, admin_boundary, osm_map, density_range) {</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert raster to stars object</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>  kde_stars <span class="ot">&lt;-</span> <span class="fu">st_as_stars</span>(kde_layer)</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the tmap plot</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(osm_map) <span class="sc">+</span></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_rgb</span>() <span class="sc">+</span></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_shape</span>(kde_stars) <span class="sc">+</span></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="st">"viridis"</span>, </span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">title =</span> <span class="st">"Density"</span>,</span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">style =</span> <span class="st">"cont"</span>,</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">breaks =</span> density_range) <span class="sc">+</span></span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_shape</span>(admin_boundary) <span class="sc">+</span></span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"KDE for"</span>, quarter),</span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.outside.position =</span> <span class="st">"right"</span>)</span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the bounding box of Myanmar</span></span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true" tabindex="-1"></a>myanmar_bbox <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(adm0)</span>
<span id="cb111-31"><a href="#cb111-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-32"><a href="#cb111-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Fetch OpenStreetMap base map</span></span>
<span id="cb111-33"><a href="#cb111-33" aria-hidden="true" tabindex="-1"></a>osm_map <span class="ot">&lt;-</span> <span class="fu">get_osm_map</span>(myanmar_bbox)</span>
<span id="cb111-34"><a href="#cb111-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-35"><a href="#cb111-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the density range</span></span>
<span id="cb111-36"><a href="#cb111-36" aria-hidden="true" tabindex="-1"></a>density_range <span class="ot">&lt;-</span> <span class="fu">get_lowest_max_density</span>(kde_layers)</span>
<span id="cb111-37"><a href="#cb111-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-38"><a href="#cb111-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all KDE layers with fixed density scale</span></span>
<span id="cb111-39"><a href="#cb111-39" aria-hidden="true" tabindex="-1"></a>kde_tmaps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(kde_layers), <span class="cf">function</span>(i) {</span>
<span id="cb111-40"><a href="#cb111-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_kde_tmap</span>(kde_layers[[i]], <span class="fu">names</span>(kde_layers)[i], adm0, osm_map, density_range)</span>
<span id="cb111-41"><a href="#cb111-41" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb111-42"><a href="#cb111-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-43"><a href="#cb111-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plots</span></span>
<span id="cb111-44"><a href="#cb111-44" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)  <span class="co"># Set tmap mode to static plotting</span></span>
<span id="cb111-45"><a href="#cb111-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (map <span class="cf">in</span> kde_tmaps) {</span>
<span id="cb111-46"><a href="#cb111-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(map)</span>
<span id="cb111-47"><a href="#cb111-47" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-46-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-46-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-46-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-46-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-46-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-46-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-46-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-46-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-46-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-46-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-46-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-46-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-46-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section" class="level1">
<h1></h1>
</section>
<section id="bonus-section-predictive-conflict-analysis" class="level1">
<h1>Bonus Section : Predictive Conflict Analysis</h1>
<p>In the pursuit of employing methods beyond those taught in class, this analysis has explored various advanced techniques and libraries in geospatial analysis. Notably, libraries such as viridis for enhanced color exploration and stars for improved raster manipulation were investigated, among others.</p>
<p>However, I would like to end this report by looking towards the future and take a more proactive approach: <strong>Predictive Conflict Analysis</strong>. This decision stems from the recognition that while our previous analyses have been primarily retrospective, there is significant value in exploring future developments.</p>
<p>Our approach thus far has primarily been retrospective, focusing on the examination and interpretation of historical conflict data in Myanmar. While this reactive analysis provides valuable insights into past trends and patterns, it leaves open the question of future developments.</p>
<p>By leveraging advanced time series forecasting techniques, specifically the Prophet package, we aim to project future conflict patterns in Myanmar. This shift from retrospective analysis to predictive modeling represents a significant step towards a more forward-looking approach in conflict studies and geospatial analysis.</p>
<p>As we delve into this predictive analysis, it’s important to note that while these forecasts offer valuable insights, they should be interpreted with caution, considering the complex and often unpredictable nature of conflict dynamics. The following analysis serves as a data-driven complement to expert knowledge and on-the-ground intelligence in understanding and anticipating conflict patterns in Myanmar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for Prophet</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>prophet_data <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ds =</span> <span class="fu">as.Date</span>(event_date)) <span class="sc">%&gt;%</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ds) <span class="sc">%&gt;%</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">y =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and fit Prophet model</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">prophet</span>(<span class="at">yearly.seasonality =</span> <span class="cn">TRUE</span>, </span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">weekly.seasonality =</span> <span class="cn">TRUE</span>, </span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">daily.seasonality =</span> <span class="cn">FALSE</span>,</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">seasonality.mode =</span> <span class="st">'multiplicative'</span>)</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">fit.prophet</span>(m, prophet_data)</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate forecast</span></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>future <span class="ot">&lt;-</span> <span class="fu">make_future_dataframe</span>(m, <span class="at">periods =</span> <span class="dv">365</span>)  <span class="co"># Forecast for next year</span></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>forecast <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, future)</span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a><span class="co">#  forecast</span></span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot</span>(m, forecast) <span class="sc">+</span></span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Overall Conflict Event Forecast for Myanmar"</span>,</span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Conflict Events"</span>)</span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot components</span></span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a>components_plot <span class="ot">&lt;-</span> <span class="fu">prophet_plot_components</span>(m, forecast)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Forecast</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-47-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li><p>Trend Analysis (Top Graph): This graph illustrates the overall trend of conflict events in Myanmar from 2021 to 2025. The y-axis represents the average number of daily conflict events, while the x-axis (labeled ‘ds’) shows the timeline.</p>
<p>The blue line depicts the trend, starting at about 10 events per day in early 2021, rapidly increasing to a peak of around 40 events per day in early 2022, followed by a gradual decline. The part of the line without any shaded area represents historical data, while the latter part (from mid 2024) is a forecast. The light blue shaded area indicates the forecast’s uncertainty, widening as it projects further into the future.</p></li>
<li><p>Day of Week (Weekly) Trends (Middle Graph): This graph shows the average effect of each day of the week on conflict event frequency, based on historical data. The y-axis percentage indicates how much the number of events deviates from the overall daily average.</p>
<p>For instance, Wednesdays show about a 5% increase in events compared to the average, while weekends (particularly Sundays) see fewer events, with approximately a 6% decrease. This pattern suggests that conflict events are more likely to occur mid-week and less likely on weekends.</p></li>
<li><p>Yearly Seasonality (3rd Graph): This graph illustrates the seasonal patterns of conflict events throughout the year, also derived from historical data. The y-axis shows the percentage deviation from the yearly average.</p>
<p>Notable peaks occur in late January/early February (about 10% increase) and November (about 20% increase), while the lowest point is in early August (about 15-20% decrease). This suggests that certain times of the year consistently see more or fewer conflict events, possibly due to factors like weather patterns, political cycles, or cultural events.</p></li>
<li><p>The last graph shows a more focused look into the forecast.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify unique event types</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>event_types <span class="ot">&lt;-</span> <span class="fu">unique</span>(conflict_data<span class="sc">$</span>event_type)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to prepare data for a specific event type</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>prepare_event_type_data <span class="ot">&lt;-</span> <span class="cf">function</span>(data, event_type) {</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(event_type <span class="sc">==</span> <span class="sc">!!</span>event_type) <span class="sc">%&gt;%</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ds =</span> <span class="fu">as.Date</span>(event_date)) <span class="sc">%&gt;%</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(ds) <span class="sc">%&gt;%</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">y =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create and fit Prophet model</span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>create_fit_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">prophet</span>(<span class="at">yearly.seasonality =</span> <span class="cn">TRUE</span>, </span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">weekly.seasonality =</span> <span class="cn">TRUE</span>, </span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">daily.seasonality =</span> <span class="cn">FALSE</span>,</span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">seasonality.mode =</span> <span class="st">'multiplicative'</span>)</span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">fit.prophet</span>(m, data)</span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(m)</span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to generate forecast</span></span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>generate_forecast <span class="ot">&lt;-</span> <span class="cf">function</span>(model, <span class="at">periods =</span> <span class="dv">365</span>) {</span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>  future <span class="ot">&lt;-</span> <span class="fu">make_future_dataframe</span>(model, <span class="at">periods =</span> periods)</span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a>  forecast <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, future)</span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(forecast)</span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot forecast</span></span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true" tabindex="-1"></a>plot_forecast <span class="ot">&lt;-</span> <span class="cf">function</span>(model, forecast, event_type) {</span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(model, forecast) <span class="sc">+</span></span>
<span id="cb114-34"><a href="#cb114-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Forecast for"</span>, event_type, <span class="st">"Events"</span>),</span>
<span id="cb114-35"><a href="#cb114-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb114-36"><a href="#cb114-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Number of Events"</span>)</span>
<span id="cb114-37"><a href="#cb114-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-38"><a href="#cb114-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-39"><a href="#cb114-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Create lists to store models and forecasts</span></span>
<span id="cb114-40"><a href="#cb114-40" aria-hidden="true" tabindex="-1"></a>event_type_models <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb114-41"><a href="#cb114-41" aria-hidden="true" tabindex="-1"></a>event_type_forecasts <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb114-42"><a href="#cb114-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-43"><a href="#cb114-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each event type</span></span>
<span id="cb114-44"><a href="#cb114-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (type <span class="cf">in</span> event_types) {</span>
<span id="cb114-45"><a href="#cb114-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare data</span></span>
<span id="cb114-46"><a href="#cb114-46" aria-hidden="true" tabindex="-1"></a>  type_data <span class="ot">&lt;-</span> <span class="fu">prepare_event_type_data</span>(conflict_data, type)</span>
<span id="cb114-47"><a href="#cb114-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-48"><a href="#cb114-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create and fit model</span></span>
<span id="cb114-49"><a href="#cb114-49" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">create_fit_model</span>(type_data)</span>
<span id="cb114-50"><a href="#cb114-50" aria-hidden="true" tabindex="-1"></a>  event_type_models[[type]] <span class="ot">&lt;-</span> model</span>
<span id="cb114-51"><a href="#cb114-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-52"><a href="#cb114-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate forecast</span></span>
<span id="cb114-53"><a href="#cb114-53" aria-hidden="true" tabindex="-1"></a>  forecast <span class="ot">&lt;-</span> <span class="fu">generate_forecast</span>(model)</span>
<span id="cb114-54"><a href="#cb114-54" aria-hidden="true" tabindex="-1"></a>  event_type_forecasts[[type]] <span class="ot">&lt;-</span> forecast</span>
<span id="cb114-55"><a href="#cb114-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-56"><a href="#cb114-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create and save plot</span></span>
<span id="cb114-57"><a href="#cb114-57" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">plot_forecast</span>(model, forecast, type)</span>
<span id="cb114-58"><a href="#cb114-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-59"><a href="#cb114-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print plot</span></span>
<span id="cb114-60"><a href="#cb114-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(plot)</span>
<span id="cb114-61"><a href="#cb114-61" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-48-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-48-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-48-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze trends across event types</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>trend_comparison <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(event_types, <span class="cf">function</span>(type) {</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  forecast <span class="ot">&lt;-</span> event_type_forecasts[[type]]</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  forecast <span class="sc">%&gt;%</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(ds, trend) <span class="sc">%&gt;%</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">event_type =</span> type)</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend comparison</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>trend_comparison_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(trend_comparison, <span class="fu">aes</span>(<span class="at">x =</span> ds, <span class="at">y =</span> trend, <span class="at">color =</span> event_type)) <span class="sc">+</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trend Comparison Across Event Types"</span>,</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Trend"</span>,</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Event Type"</span>) <span class="sc">+</span></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Print trend comparison plot </span></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(trend_comparison_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Takehome_Ex1_files/figure-html/unnamed-chunk-48-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="forecast-analysis" class="level2">
<h2 class="anchored" data-anchor-id="forecast-analysis">Forecast Analysis</h2>
<p>The predictive analysis of conflict events in Myanmar reveals a complex and evolving situation. While the overall conflict level is projected to remain relatively stable or slightly increase, a deeper examination of specific event types uncovers significant shifts in the nature of the conflict.</p>
<p>Key findings:</p>
<ol type="1">
<li><p><strong>Overall Conflict Trend</strong>: The general level of conflict is expected to persist or marginally increase, indicating ongoing instability in the region.</p></li>
<li><p><strong>Divergent Event Type Trends</strong>:</p>
<ul>
<li>Strategic developments and violence against civilians are projected to decrease.</li>
<li>Battles and explosions/remote violence are forecast to increase.</li>
</ul></li>
<li><p><strong>Interpretation</strong>: This pattern suggests that the conflict may be entering a new phase. The reduction in strategic developments and civilian-targeted violence, coupled with an increase in direct confrontations (battles) and remote attacks, indicates a potential intensification of military engagements between opposing forces.</p>
<p><strong>Context</strong>: These projections align with recent analyses of the situation in Myanmar. As noted in a Council on Foreign Relations article, “The rest of this year is now shaping up to be critical for both the junta and the opposition forces, who have generally maintained their alliance.” This assessment supports our forecast that the conflict may be approaching a critical juncture or peak.</p></li>
</ol>
<p><a href="https://www.cfr.org/blog/will-2024-be-juntas-end-myanmar" class="uri">https://www.cfr.org/blog/will-2024-be-juntas-end-myanmar</a></p>
<p>This indicates that the coming months could be decisive in shaping the future trajectory of the conflict in Myanmar.</p>
</section>
</section>
<section id="conclusion-spatio-temporal-patterns-analysis-summary" class="level1">
<h1>Conclusion: Spatio-Temporal Patterns Analysis Summary</h1>
<p>Our comprehensive spatio-temporal analysis of conflict patterns in Myanmar has yielded several consistent and significant findings:</p>
<ol type="1">
<li><p><strong>Concentration of Conflict in Border Zones</strong>: All analytical approaches employed in this study corroborate that the fighting is predominantly concentrated in regions that form the border zones between Junta-controlled areas and rebel-held territories. Specifically:</p>
<ul>
<li>The regions of Sagaing, Mandalay, and Magway represent critical border zones between Junta and rebel forces in the central and northern parts of the country.</li>
<li>Yangon, in the south, is also a key part of this border zone, experiencing significant conflict due to its strategic importance and its position at the frontier between Junta and rebel-controlled areas.</li>
</ul></li>
<li><p><strong>Intensity of Conflict in Border Regions</strong>: These border zones - Sagaing, Mandalay, Magway, and Yangon - consistently show the highest intensity of conflict activities.</p></li>
<li><p><strong>Relative Calm in Core-Controlled Areas</strong>: In contrast to these border zones, areas firmly under the control of either the Junta or rebel forces have demonstrated lower levels of conflict.</p></li>
<li><p><strong>Predictive Model Insights</strong>: Our predictive modeling suggests that the conflict is approaching a critical juncture:</p>
<ul>
<li>A projected decrease in violence against civilians and strategic developments is anticipated.</li>
<li>Conversely, an increase in battles and explosive events is forecasted, indicating a potential escalation in direct confrontations.</li>
</ul></li>
<li><p><strong>Indications of an Impending Decisive Clash</strong>: The shift in conflict patterns, as indicated by our predictive model, aligns with reports and analyses suggesting that both sides of the conflict are preparing for a decisive engagement. This impending climax in the conflict underscores the urgent need for conflict resolution initiatives and humanitarian preparedness.</p></li>
</ol>
</section>
<section id="references" class="level1">
<h1>References</h1>
<ol type="1">
<li><em>The International Institute for Strategic Studies.</em> (n.d.). Myanmar. The International Institute for Strategic Studies. <a href="https://myanmar.iiss.org/" class="uri">https://myanmar.iiss.org/</a></li>
<li>Beech, H., &amp; Wei, C. (2024, April 20). What’s Happening in Myanmar’s Civil War?. <em>The New York Times.</em> <a href="https://www.nytimes.com/interactive/2024/04/20/world/asia/myanmar-civil-war.html" class="uri">https://www.nytimes.com/interactive/2024/04/20/world/asia/myanmar-civil-war.html</a></li>
<li><em>Special Advisory Council for Myanmar.</em> (n.d.). Special Advisory Council for Myanmar. <a href="https://specialadvisorycouncil.org/" class="uri">https://specialadvisorycouncil.org/</a></li>
<li><em>United States Institute of Peace.</em> (2022, November 10). Understanding the People’s Defense Forces in Myanmar. <a href="https://www.usip.org/publications/2022/11/understanding-peoples-defense-forces-myanmar" class="uri">https://www.usip.org/publications/2022/11/understanding-peoples-defense-forces-myanmar</a></li>
<li><em>Al Jazeera.</em> (2024, January 16). What is Myanmar’s Three Brotherhood Alliance that’s resisting the military? <a href="https://www.aljazeera.com/news/2024/1/16/what-is-myanmars-three-brotherhood-alliance-thats-resisting-the-military" class="uri">https://www.aljazeera.com/news/2024/1/16/what-is-myanmars-three-brotherhood-alliance-thats-resisting-the-military</a></li>
<li><em>Council of Foreign Relations</em>(2024, January 13). Will 2024 be the junta’s end in Myanmar? <em>Council on Foreign Relations.</em> <a href="#0">https://www.cfr.org/blog/will-2024-be-juntas-end-myanmar</a></li>
<li><em>Claude AI.</em> (n.d.). Claude AI. <a href="https://claude.ai/" class="uri">https://claude.ai/</a></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>